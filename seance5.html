<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Séance 5: TD2 - Critères d’Évaluation – Machine Learning et Deep Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./seance6.html" rel="next">
<link href="./seance4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-f1aadacce99040138bbb613f9330654f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-670c757105cc8b81a53606a71844536c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-b7200e4a2f6cd71dc52354e94e906ccc.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-670c757105cc8b81a53606a71844536c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<!-- Google Translate Widget -->
</head><body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script><div id="google_translate_element"></div>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'fr',
    includedLanguages: 'fr,en', // Seulement FR et EN
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
    autoDisplay: false
  }, 'google_translate_element');
}
</script>

<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<style>
/* Style pour le widget Google Translate - MODIFIÉ */
#google_translate_element {
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 9999;
  background: white;
  padding: 2px;
  border-radius: 20px; /* Forme arrondie */
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  border: 1px solid #ddd;
}

/* Cacher le branding Google */
.goog-te-gadget {
  font-size: 0 !important;
}

.goog-te-gadget-simple {
  background-color: transparent !important;
  border: none !important;
  padding: 0 !important;
}

.goog-te-menu-value span {
  color: #333 !important;
  font-size: 13px !important;
}

.goog-te-menu-value {
  color: #333 !important;
  border: none !important;
  background: transparent !important;
  padding: 4px 10px !important;
  border-radius: 15px !important;
}

/* Style personnalisé - Afficher seulement FR/EN */
.goog-te-gadget .goog-te-menu-value span:first-child {
  display: none !important;
}

/* Remplacer le texte par FR/EN seulement */
.goog-te-gadget .goog-te-menu-value span:last-child {
  display: inline-block;
  min-width: 30px;
  text-align: center;
}

/* Cacher la flèche */
.goog-te-gadget .goog-te-menu-value span:last-child:after {
  content: '';
  display: none;
}

/* Correction pour l'affichage */
.goog-te-banner-frame.skiptranslate {
  display: none !important;
}

body {
  top: 0px !important;
}

/* Style pour le menu déroulant */
.goog-te-menu2 {
  border-radius: 10px !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15) !important;
  border: 1px solid #eee !important;
  min-width: 60px !important;
}

.goog-te-menu2-item {
  padding: 8px 12px !important;
  font-size: 13px !important;
  text-align: center;
}

/* Garder seulement FR et EN dans le menu */
.goog-te-menu2-item div:first-child {
  font-weight: 500;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./seance1.html">Partie 1: Machine Learning Fondamental</a></li><li class="breadcrumb-item"><a href="./seance5.html"><span class="chapter-title">Séance 5: TD2 - Critères d’Évaluation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Machine Learning et Deep Learning</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/nevermind78/Ml_DL" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation du Cours</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Partie 1: Machine Learning Fondamental</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 1: Introduction IA et Machine Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 2: Apprentissage Supervisé - Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 3: TP1 - Pipeline de Classification Binaire</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 4: TD1 - Modèles de Classification de Base</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance5.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Séance 5: TD2 - Critères d’Évaluation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 6: TP2 - Classification Multi-classes &amp; Optimisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 7: Cours - Apprentissage Supervisé : Régression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 8: TP3 - Régression &amp; Optimisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 9: Apprentissage Non Supervisé</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seance10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Séance 10: TP4 - Clustering &amp; Réduction de Dimension</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#la-matrice-de-confusion" id="toc-la-matrice-de-confusion" class="nav-link" data-scroll-target="#la-matrice-de-confusion">1. La Matrice de Confusion</a>
  <ul class="collapse">
  <li><a href="#définition-et-structure" id="toc-définition-et-structure" class="nav-link" data-scroll-target="#définition-et-structure">1.1 Définition et Structure</a></li>
  <li><a href="#exemple-concret-détection-de-maladie" id="toc-exemple-concret-détection-de-maladie" class="nav-link" data-scroll-target="#exemple-concret-détection-de-maladie">1.2 Exemple Concret: Détection de Maladie</a></li>
  <li><a href="#exercice-1.1-construction-de-matrice-de-confusion" id="toc-exercice-1.1-construction-de-matrice-de-confusion" class="nav-link" data-scroll-target="#exercice-1.1-construction-de-matrice-de-confusion">Exercice 1.1: Construction de Matrice de Confusion</a></li>
  </ul></li>
  <li><a href="#métriques-dérivées" id="toc-métriques-dérivées" class="nav-link" data-scroll-target="#métriques-dérivées">2. Métriques Dérivées</a>
  <ul class="collapse">
  <li><a href="#accuracy-exactitude" id="toc-accuracy-exactitude" class="nav-link" data-scroll-target="#accuracy-exactitude">2.1 Accuracy (Exactitude)</a></li>
  <li><a href="#precision-précision" id="toc-precision-précision" class="nav-link" data-scroll-target="#precision-précision">2.2 Precision (Précision)</a></li>
  <li><a href="#recall-rappel-ou-sensitivity-sensibilité" id="toc-recall-rappel-ou-sensitivity-sensibilité" class="nav-link" data-scroll-target="#recall-rappel-ou-sensitivity-sensibilité">2.3 Recall (Rappel) ou Sensitivity (Sensibilité)</a></li>
  <li><a href="#compromis-precision-recall" id="toc-compromis-precision-recall" class="nav-link" data-scroll-target="#compromis-precision-recall">2.4 Compromis Precision-Recall</a></li>
  <li><a href="#f1-score" id="toc-f1-score" class="nav-link" data-scroll-target="#f1-score">2.5 F1-Score</a></li>
  <li><a href="#autres-métriques" id="toc-autres-métriques" class="nav-link" data-scroll-target="#autres-métriques">2.6 Autres Métriques</a></li>
  <li><a href="#exercice-2.1-calcul-de-métriques" id="toc-exercice-2.1-calcul-de-métriques" class="nav-link" data-scroll-target="#exercice-2.1-calcul-de-métriques">Exercice 2.1: Calcul de Métriques</a></li>
  </ul></li>
  <li><a href="#courbe-roc-et-auc" id="toc-courbe-roc-et-auc" class="nav-link" data-scroll-target="#courbe-roc-et-auc">3. Courbe ROC et AUC</a>
  <ul class="collapse">
  <li><a href="#courbe-roc-receiver-operating-characteristic" id="toc-courbe-roc-receiver-operating-characteristic" class="nav-link" data-scroll-target="#courbe-roc-receiver-operating-characteristic">3.1 Courbe ROC (Receiver Operating Characteristic)</a></li>
  <li><a href="#auc-area-under-curve" id="toc-auc-area-under-curve" class="nav-link" data-scroll-target="#auc-area-under-curve">3.2 AUC (Area Under Curve)</a></li>
  <li><a href="#exercice-3.1-analyse-de-courbe-roc" id="toc-exercice-3.1-analyse-de-courbe-roc" class="nav-link" data-scroll-target="#exercice-3.1-analyse-de-courbe-roc">Exercice 3.1: Analyse de Courbe ROC</a></li>
  </ul></li>
  <li><a href="#choix-de-métriques-selon-le-contexte" id="toc-choix-de-métriques-selon-le-contexte" class="nav-link" data-scroll-target="#choix-de-métriques-selon-le-contexte">4. Choix de Métriques selon le Contexte</a>
  <ul class="collapse">
  <li><a href="#tableau-de-décision" id="toc-tableau-de-décision" class="nav-link" data-scroll-target="#tableau-de-décision">4.1 Tableau de Décision</a></li>
  <li><a href="#classes-déséquilibrées" id="toc-classes-déséquilibrées" class="nav-link" data-scroll-target="#classes-déséquilibrées">4.2 Classes Déséquilibrées</a></li>
  <li><a href="#exercice-4.1-choix-de-métrique" id="toc-exercice-4.1-choix-de-métrique" class="nav-link" data-scroll-target="#exercice-4.1-choix-de-métrique">Exercice 4.1: Choix de Métrique</a></li>
  </ul></li>
  <li><a href="#exercice-récapitulatif-complet" id="toc-exercice-récapitulatif-complet" class="nav-link" data-scroll-target="#exercice-récapitulatif-complet">5. Exercice Récapitulatif Complet</a>
  <ul class="collapse">
  <li><a href="#scénario-détecteur-de-défauts-en-usine" id="toc-scénario-détecteur-de-défauts-en-usine" class="nav-link" data-scroll-target="#scénario-détecteur-de-défauts-en-usine">Scénario: Détecteur de Défauts en Usine</a></li>
  </ul></li>
  <li><a href="#comparaison-critique-des-résultats" id="toc-comparaison-critique-des-résultats" class="nav-link" data-scroll-target="#comparaison-critique-des-résultats">6. Comparaison Critique des Résultats</a>
  <ul class="collapse">
  <li><a href="#exercice-6.1-analyse-comparative" id="toc-exercice-6.1-analyse-comparative" class="nav-link" data-scroll-target="#exercice-6.1-analyse-comparative">Exercice 6.1: Analyse Comparative</a></li>
  </ul></li>
  <li><a href="#résumé-de-la-séance" id="toc-résumé-de-la-séance" class="nav-link" data-scroll-target="#résumé-de-la-séance">Résumé de la Séance</a></li>
  <li><a href="#checklist-de-maîtrise" id="toc-checklist-de-maîtrise" class="nav-link" data-scroll-target="#checklist-de-maîtrise">Checklist de Maîtrise</a></li>
  <li><a href="#exercices-supplémentaires" id="toc-exercices-supplémentaires" class="nav-link" data-scroll-target="#exercices-supplémentaires">Exercices Supplémentaires</a></li>
  <li><a href="#préparation-séance-suivante" id="toc-préparation-séance-suivante" class="nav-link" data-scroll-target="#préparation-séance-suivante">Préparation Séance Suivante</a></li>
  <li><a href="#ressources-complémentaires" id="toc-ressources-complémentaires" class="nav-link" data-scroll-target="#ressources-complémentaires">Ressources Complémentaires</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./seance1.html">Partie 1: Machine Learning Fondamental</a></li><li class="breadcrumb-item"><a href="./seance5.html"><span class="chapter-title">Séance 5: TD2 - Critères d’Évaluation</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Séance 5: TD2 - Critères d’Évaluation</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Informations de la séance
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Type</strong>: Travaux Dirigés</li>
<li><strong>Durée</strong>: 2h</li>
<li><strong>Objectifs</strong>: Obj4</li>
</ul>
</div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>L’évaluation correcte d’un modèle de classification est cruciale. Choisir la mauvaise métrique peut conduire à des conclusions erronées et à des modèles inadaptés en production. Dans ce TD, nous allons explorer en profondeur les différentes métriques d’évaluation.</p>
</section>
<section id="la-matrice-de-confusion" class="level2">
<h2 class="anchored" data-anchor-id="la-matrice-de-confusion">1. La Matrice de Confusion</h2>
<section id="définition-et-structure" class="level3">
<h3 class="anchored" data-anchor-id="définition-et-structure">1.1 Définition et Structure</h3>
<p>La <strong>matrice de confusion</strong> est un tableau qui visualise les performances d’un modèle de classification en comparant les prédictions aux vraies valeurs.</p>
<p>Pour un problème <strong>binaire</strong>:</p>
<pre><code>                    Prédiction
                 Négatif  Positif
Réalité  Négatif    TN       FP
         Positif    FN       TP</code></pre>
<p>Où:</p>
<ul>
<li><strong>TP (True Positive)</strong>: Vrais Positifs - correctement classifiés comme positifs</li>
<li><strong>TN (True Negative)</strong>: Vrais Négatifs - correctement classifiés comme négatifs</li>
<li><strong>FP (False Positive)</strong>: Faux Positifs - incorrectement classifiés comme positifs (Erreur Type I)</li>
<li><strong>FN (False Negative)</strong>: Faux Négatifs - incorrectement classifiés comme négatifs (Erreur Type II)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Mnémotechnique
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Type I (FP)</strong>: Fausse alarme - “On crie au loup alors qu’il n’y a pas de loup”</li>
<li><strong>Type II (FN)</strong>: Manque - “On ne voit pas le loup alors qu’il est là”</li>
</ul>
</div>
</div>
</section>
<section id="exemple-concret-détection-de-maladie" class="level3">
<h3 class="anchored" data-anchor-id="exemple-concret-détection-de-maladie">1.2 Exemple Concret: Détection de Maladie</h3>
<p>Considérez un test médical pour une maladie:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Patient</th>
<th>Vraie Classe</th>
<th>Prédiction</th>
<th>Résultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Malade</td>
<td>Malade</td>
<td>TP <span class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Malade</td>
<td>Sain</td>
<td>FN X (Dangereux!)</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Sain</td>
<td>Malade</td>
<td>FP X (Fausse alarme)</td>
</tr>
<tr class="even">
<td>4</td>
<td>Sain</td>
<td>Sain</td>
<td>TN <span class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Malade</td>
<td>Malade</td>
<td>TP <span class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>Sain</td>
<td>Sain</td>
<td>TN <span class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Malade</td>
<td>Sain</td>
<td>FN X (Dangereux!)</td>
</tr>
<tr class="even">
<td>8</td>
<td>Sain</td>
<td>Malade</td>
<td>FP X (Fausse alarme)</td>
</tr>
</tbody>
</table>
<p>Matrice de confusion:</p>
<pre><code>              Prédiction
           Sain  Malade
Réalité Sain   2      2      (4 sains)
      Malade   2      2      (4 malades)</code></pre>
<ul>
<li><strong>TP = 2</strong>: Malades correctement détectés</li>
<li><strong>TN = 2</strong>: Sains correctement identifiés</li>
<li><strong>FP = 2</strong>: Sains diagnostiqués malades (traitement inutile)</li>
<li><strong>FN = 2</strong>: Malades non détectés (très dangereux!)</li>
</ul>
</section>
<section id="exercice-1.1-construction-de-matrice-de-confusion" class="level3">
<h3 class="anchored" data-anchor-id="exercice-1.1-construction-de-matrice-de-confusion">Exercice 1.1: Construction de Matrice de Confusion</h3>
<p>Soit les prédictions suivantes pour un détecteur de spam (1 = Spam, 0 = Ham):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>y_true <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions:</strong> 1. Construisez la matrice de confusion 2. Calculez TP, TN, FP, FN 3. Interprétez chaque type d’erreur dans ce contexte</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution Exercice 1.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="7dc6fb29" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>y_true <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Matrice de confusion</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. Matrice de Confusion:"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            xticklabels<span class="op">=</span>[<span class="st">'Ham (0)'</span>, <span class="st">'Spam (1)'</span>],</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>[<span class="st">'Ham (0)'</span>, <span class="st">'Spam (1)'</span>])</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Vraie Classe'</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Prédiction'</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matrice de Confusion - Détection de Spam'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calcul manuel</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm.ravel()</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">2. Valeurs:"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TP (Vrais Positifs) = </span><span class="sc">{</span>tp<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TN (Vrais Négatifs) = </span><span class="sc">{</span>tn<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FP (Faux Positifs) = </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FN (Faux Négatifs) = </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification manuelle</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Interprétation:"</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TP = </span><span class="sc">{</span>tp<span class="sc">}</span><span class="ss">: Spams correctement détectés"</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TN = </span><span class="sc">{</span>tn<span class="sc">}</span><span class="ss">: Hams correctement identifiés"</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FP = </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss">: Hams classés comme spam (vont en indésirables)"</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FN = </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss">: Spams non détectés (arrivent en boîte de réception)"</span>)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse détaillée</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Analyse détaillée des prédictions:"</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (true, pred) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(y_true, y_pred)):</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    status <span class="op">=</span> <span class="st">""</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> true <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"TP $</span><span class="er">\</span><span class="st">checkmark$"</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> true <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"TN $</span><span class="er">\</span><span class="st">checkmark$"</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> true <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"FP X"</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> true <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"FN X"</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    true_label <span class="op">=</span> <span class="st">"Spam"</span> <span class="cf">if</span> true <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">"Ham"</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    pred_label <span class="op">=</span> <span class="st">"Spam"</span> <span class="cf">if</span> pred <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">"Ham"</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Email </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: Vrai=</span><span class="sc">{</span>true_label<span class="sc">}</span><span class="ss">, Prédit=</span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss"> → </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Réponses:</strong></p>
<ol type="1">
<li><p>Matrice: <code>[[4, 1], [1, 4]]</code></p></li>
<li><p>TP=4, TN=4, FP=1, FN=1</p></li>
<li><p>Interprétation:</p>
<ul>
<li><strong>FP (1 email)</strong>: Email légitime envoyé dans spam (utilisateur peut manquer info importante)</li>
<li><strong>FN (1 email)</strong>: Spam non détecté dans boîte réception (nuisance mineure)</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="métriques-dérivées" class="level2">
<h2 class="anchored" data-anchor-id="métriques-dérivées">2. Métriques Dérivées</h2>
<section id="accuracy-exactitude" class="level3">
<h3 class="anchored" data-anchor-id="accuracy-exactitude">2.1 Accuracy (Exactitude)</h3>
<p><strong>Définition</strong>: Proportion de prédictions correctes</p>
<p><span class="math display">\[\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN}\]</span></p>
<div id="dc1c321a" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_true, y_pred)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Piège de l’Accuracy!
</div>
</div>
<div class="callout-body-container callout-body">
<p>L’accuracy peut être <strong>trompeuse</strong> avec des classes déséquilibrées!</p>
<p><strong>Exemple</strong>: Détection de fraude</p>
<ul>
<li>990 transactions légitimes, 10 frauduleuses</li>
<li>Modèle naïf qui prédit toujours “légitime”</li>
<li>Accuracy = 990/1000 = <strong>99%</strong></li>
<li>Mais 0% de fraudes détectées!</li>
</ul>
</div>
</div>
</section>
<section id="precision-précision" class="level3">
<h3 class="anchored" data-anchor-id="precision-précision">2.2 Precision (Précision)</h3>
<p><strong>Définition</strong>: Proportion de prédictions positives qui sont correctes</p>
<p><span class="math display">\[\text{Precision} = \frac{TP}{TP + FP}\]</span></p>
<p><strong>Question répondue</strong>: “Parmi tous les cas prédits positifs, combien le sont vraiment?”</p>
<p><strong>Interprétation</strong>:</p>
<ul>
<li>Haute précision → Peu de faux positifs</li>
<li>Important quand le coût d’un FP est élevé</li>
</ul>
<div id="fc909951" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_true, y_pred)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Exemples où la Precision est cruciale</strong>:</p>
<ol type="1">
<li><strong>Recommandation de produits</strong>: Ne pas recommander des produits non pertinents</li>
<li><strong>Filtrage spam</strong>: Ne pas mettre d’emails importants dans spam</li>
<li><strong>Détection de visages</strong>: Ne pas identifier de faux visages</li>
</ol>
</section>
<section id="recall-rappel-ou-sensitivity-sensibilité" class="level3">
<h3 class="anchored" data-anchor-id="recall-rappel-ou-sensitivity-sensibilité">2.3 Recall (Rappel) ou Sensitivity (Sensibilité)</h3>
<p><strong>Définition</strong>: Proportion de vrais positifs correctement identifiés</p>
<p><span class="math display">\[\text{Recall} = \frac{TP}{TP + FN}\]</span></p>
<p><strong>Question répondue</strong>: “Parmi tous les cas réellement positifs, combien ai-je détectés?”</p>
<p><strong>Interprétation</strong>:</p>
<ul>
<li>Haut recall → Peu de faux négatifs</li>
<li>Important quand le coût d’un FN est élevé</li>
</ul>
<div id="85ac84db" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_true, y_pred)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Exemples où le Recall est crucial</strong>:</p>
<ol type="1">
<li><strong>Détection de cancer</strong>: Ne manquer aucun malade</li>
<li><strong>Détection de fraude</strong>: Détecter toutes les fraudes</li>
<li><strong>Systèmes de sécurité</strong>: Ne rater aucune menace</li>
</ol>
</section>
<section id="compromis-precision-recall" class="level3">
<h3 class="anchored" data-anchor-id="compromis-precision-recall">2.4 Compromis Precision-Recall</h3>
<p>Il existe généralement un <strong>compromis</strong> entre Precision et Recall:</p>
<p><strong>Diagramme mermaid :</strong></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Seuil bas0.3] --&gt; B[Haute RecallBasse Precision]
    C[Seuil moyen0.5] --&gt; D[Équilibre]
    E[Seuil haut0.7] --&gt; F[Haute PrecisionBasse Recall]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Exemple concret</strong>:</p>
<div id="47b9079e" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de détection de maladie</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Proba patient malade: 0.6</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Seuil = 0.5: Prédit malade → Haute recall</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Seuil = 0.8: Prédit sain → Haute precision (mais manque des cas)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="f1-score" class="level3">
<h3 class="anchored" data-anchor-id="f1-score">2.5 F1-Score</h3>
<p><strong>Définition</strong>: Moyenne harmonique de Precision et Recall</p>
<p><span class="math display">\[F_1 = 2 \times \frac{\text{Precision} \times \text{Recall}}{\text{Precision} + \text{Recall}}\]</span></p>
<p><strong>Pourquoi moyenne harmonique?</strong></p>
<ul>
<li>Pénalise les déséquilibres</li>
<li>Si Precision=100% et Recall=1%, F1 <span class="math inline">\(\approx\)</span> 2% (pas 50.5%)</li>
</ul>
<div id="d66e5aa0" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_true, y_pred)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (precision <span class="op">*</span> recall) <span class="op">/</span> (precision <span class="op">+</span> recall)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Quand utiliser F1?</strong> - Besoin d’équilibre entre Precision et Recall - Classes déséquilibrées - Vouloir une seule métrique résumée</p>
</section>
<section id="autres-métriques" class="level3">
<h3 class="anchored" data-anchor-id="autres-métriques">2.6 Autres Métriques</h3>
<p><strong>Specificity (Spécificité)</strong>:</p>
<p><span class="math display">\[\text{Specificity} = \frac{TN}{TN + FP}\]</span> Proportion de vrais négatifs correctement identifiés</p>
<p><strong>F-Beta Score</strong>:</p>
<p><span class="math display">\[F_\beta = (1 + \beta^2) \times \frac{\text{Precision} \times \text{Recall}}{\beta^2 \times \text{Precision} + \text{Recall}}\]</span></p>
<ul>
<li><span class="math inline">\(\beta &gt; 1\)</span>: Favorise le Recall</li>
<li><span class="math inline">\(\beta &lt; 1\)</span>: Favorise la Precision</li>
</ul>
</section>
<section id="exercice-2.1-calcul-de-métriques" class="level3">
<h3 class="anchored" data-anchor-id="exercice-2.1-calcul-de-métriques">Exercice 2.1: Calcul de Métriques</h3>
<p>Soit la matrice de confusion suivante pour un détecteur de tumeurs malignes:</p>
<pre><code>              Prédiction
           Bénigne  Maligne
Réalité Bénigne    850      50
       Maligne     20       80</code></pre>
<p><strong>Questions:</strong></p>
<ol type="1">
<li>Calculez Accuracy, Precision, Recall, F1-Score</li>
<li>Quelle métrique est la plus importante dans ce contexte? Pourquoi?</li>
<li>Le modèle est-il satisfaisant? Justifiez.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution Exercice 2.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="91f65d06" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          Bénigne  Maligne</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bénigne    850      50</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Maligne     20      80</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>tn <span class="op">=</span> <span class="dv">850</span>  <span class="co"># Bénigne correctement identifié</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> <span class="dv">50</span>   <span class="co"># Bénigne prédit Maligne</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="dv">20</span>   <span class="co"># Maligne prédit Bénigne</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>tp <span class="op">=</span> <span class="dv">80</span>   <span class="co"># Maligne correctement identifié</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> tn <span class="op">+</span> fp <span class="op">+</span> fn <span class="op">+</span> tp</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Calcul des métriques</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> total</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (precision <span class="op">*</span> recall) <span class="op">/</span> (precision <span class="op">+</span> recall)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>specificity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. Métriques calculées:"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy:    </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>accuracy<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precision:   </span><span class="sc">{</span>precision<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>precision<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Recall:      </span><span class="sc">{</span>recall<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>recall<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F1-Score:    </span><span class="sc">{</span>f1<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>f1<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Specificity: </span><span class="sc">{</span>specificity<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>specificity<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Métrique la plus importante</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Métrique la plus importante: RECALL"</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Raison: En médical, ne pas détecter un cancer (FN) est"</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   beaucoup plus grave qu'une fausse alarme (FP)."</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Actuellement, Recall = </span><span class="sc">{</span>recall<span class="sc">:.2%}</span><span class="ss"> signifie que"</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> cancers sur </span><span class="sc">{</span>tp<span class="op">+</span>fn<span class="sc">}</span><span class="ss"> ne sont pas détectés!"</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Évaluation</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Évaluation du modèle:"</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   X Recall de </span><span class="sc">{</span>recall<span class="sc">:.2%}</span><span class="ss"> est INSUFFISANT"</span>)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   X 20% de cancers manqués = inacceptable"</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   $</span><span class="er">\</span><span class="ss">checkmark$ Precision de </span><span class="sc">{</span>precision<span class="sc">:.2%}</span><span class="ss"> est correcte"</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   $</span><span class="er">\</span><span class="ss">checkmark$ Specificity de </span><span class="sc">{</span>specificity<span class="sc">:.2%}</span><span class="ss"> est bonne"</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   CONCLUSION: Modèle à améliorer!"</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Recommandation: Abaisser le seuil de décision pour"</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   augmenter le Recall, même au prix de la Precision."</span>)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Impact en nombre de patients</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Impact sur 1000 patients:"</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - 20 cancers NON DÉTECTÉS (FN) ← CRITIQUE"</span>)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - 50 fausses alarmes (FP) ← Acceptable (examens complémentaires)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Réponses:</strong></p>
<ol type="1">
<li><strong>Métriques:</strong>
<ul>
<li>Accuracy: 93.00%</li>
<li>Precision: 61.54%</li>
<li>Recall: 80.00%</li>
<li>F1-Score: 69.57%</li>
<li>Specificity: 94.44%</li>
</ul></li>
<li><strong>Métrique importante: RECALL</strong>
<ul>
<li>Un cancer non détecté (FN) peut être mortel</li>
<li>Une fausse alarme (FP) → examens supplémentaires (acceptable)</li>
<li>Donc: mieux vaut trop détecter que pas assez</li>
</ul></li>
<li><strong>Évaluation:</strong>
<ul>
<li>X Recall de 80% <strong>insuffisant</strong> (20% de cancers manqués)</li>
<li><span class="math inline">\(\checkmark\)</span> Specificity correcte</li>
<li><strong>Conclusion</strong>: Modèle dangereux en l’état</li>
<li><strong>Action</strong>: Réduire le seuil pour augmenter Recall</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="courbe-roc-et-auc" class="level2">
<h2 class="anchored" data-anchor-id="courbe-roc-et-auc">3. Courbe ROC et AUC</h2>
<section id="courbe-roc-receiver-operating-characteristic" class="level3">
<h3 class="anchored" data-anchor-id="courbe-roc-receiver-operating-characteristic">3.1 Courbe ROC (Receiver Operating Characteristic)</h3>
<p>La <strong>courbe ROC</strong> visualise les performances d’un classificateur binaire en variant le seuil de décision.</p>
<p><strong>Axes:</strong></p>
<ul>
<li><strong>X</strong>: False Positive Rate (FPR) = <span class="math inline">\(\frac{FP}{FP + TN}\)</span> = 1 - Specificity</li>
<li><strong>Y</strong>: True Positive Rate (TPR) = <span class="math inline">\(\frac{TP}{TP + FN}\)</span> = Recall</li>
</ul>
<div id="d7648f39" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, roc_auc_score</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir les probabilités (pas les classes)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>y_proba <span class="op">=</span> model.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les points de la courbe ROC</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresholds <span class="op">=</span> roc_curve(y_test, y_proba)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracer la courbe</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'ROC Curve'</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>, label<span class="op">=</span><span class="st">'Random (AUC=0.5)'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False Positive Rate (1 - Specificity)'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Positive Rate (Recall)'</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Courbe ROC'</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Interprétation des points:</strong></p>
<ul>
<li><strong>Point (0, 0)</strong>: Tout prédit négatif (seuil = 1.0)</li>
<li><strong>Point (1, 1)</strong>: Tout prédit positif (seuil = 0.0)</li>
<li><strong>Point (0, 1)</strong>: Classificateur parfait</li>
<li><strong>Diagonale</strong>: Classificateur aléatoire</li>
</ul>
</section>
<section id="auc-area-under-curve" class="level3">
<h3 class="anchored" data-anchor-id="auc-area-under-curve">3.2 AUC (Area Under Curve)</h3>
<p>L’<strong>AUC</strong> est l’aire sous la courbe ROC.</p>
<p><strong>Interprétation:</strong></p>
<ul>
<li><strong>AUC = 1.0</strong>: Classificateur parfait</li>
<li><strong>AUC = 0.9 - 1.0</strong>: Excellent</li>
<li><strong>AUC = 0.8 - 0.9</strong>: Très bon</li>
<li><strong>AUC = 0.7 - 0.8</strong>: Bon</li>
<li><strong>AUC = 0.6 - 0.7</strong>: Médiocre</li>
<li><strong>AUC = 0.5</strong>: Aléatoire (inutile)</li>
<li><strong>AUC &lt; 0.5</strong>: Pire qu’aléatoire (inverser les prédictions!)</li>
</ul>
<div id="ca8f78f5" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l'AUC</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>auc <span class="op">=</span> roc_auc_score(y_test, y_proba)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"AUC Score: </span><span class="sc">{</span>auc<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Avantages de l’AUC:</strong></p>
<ul>
<li>Indépendant du seuil de décision</li>
<li>Robuste aux classes déséquilibrées</li>
<li>Facile à interpréter (une seule valeur)</li>
</ul>
<p><strong>Signification probabiliste:</strong></p>
<p>AUC = probabilité qu’un exemple positif aléatoire ait un score plus élevé qu’un exemple négatif aléatoire</p>
</section>
<section id="exercice-3.1-analyse-de-courbe-roc" class="level3">
<h3 class="anchored" data-anchor-id="exercice-3.1-analyse-de-courbe-roc">Exercice 3.1: Analyse de Courbe ROC</h3>
<p>Vous avez trois modèles avec les AUC suivants:</p>
<ul>
<li>Modèle A: AUC = 0.95</li>
<li>Modèle B: AUC = 0.75</li>
<li>Modèle C: AUC = 0.52</li>
</ul>
<p><strong>Questions:</strong></p>
<ol type="1">
<li>Classez les modèles par performance</li>
<li>Quel modèle choisiriez-vous pour détecter des fraudes bancaires?</li>
<li>Dans quel cas le Modèle C pourrait-il être utile?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution Exercice 3.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="ff215dad" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation de courbes ROC</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle A (excellent)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>fpr_a <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>tpr_a <span class="op">=</span> np.power(fpr_a, <span class="fl">0.2</span>)  <span class="co"># Courbe très au-dessus de la diagonale</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle B (bon)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>fpr_b <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>tpr_b <span class="op">=</span> np.power(fpr_b, <span class="fl">0.6</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle C (quasi-aléatoire)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>fpr_c <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>tpr_c <span class="op">=</span> fpr_c <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="dv">100</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>tpr_c <span class="op">=</span> np.clip(tpr_c, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_a, tpr_a, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Modèle A (AUC=0.95)'</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_b, tpr_b, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Modèle B (AUC=0.75)'</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_c, tpr_c, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Modèle C (AUC=0.52)'</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'Aléatoire (AUC=0.5)'</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False Positive Rate'</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Positive Rate'</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparaison des Courbes ROC'</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. Classement par performance:"</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1er: Modèle A (AUC=0.95) - Excellent"</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2e:  Modèle B (AUC=0.75) - Bon"</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3e:  Modèle C (AUC=0.52) - Quasi-aléatoire"</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Pour détecter des fraudes:"</span>)</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   → Modèle A (AUC=0.95)"</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Raison: Meilleure capacité à distinguer fraude/légitime"</span>)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Permet d'ajuster le seuil selon coût FP vs FN"</span>)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Utilité du Modèle C:"</span>)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   → Quasiment aucune!"</span>)</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   AUC=0.52 $</span><span class="ch">\a</span><span class="st">pprox$ tirage à pile ou face"</span>)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   SAUF: Si on inverse ses prédictions → AUC=0.48"</span>)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   → Peut indiquer un bug dans le code/labels"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Réponses:</strong></p>
<ol type="1">
<li><p><strong>Classement</strong>: A &gt; B &gt; C</p>
<ul>
<li>A est excellent</li>
<li>B est bon mais moins performant</li>
<li>C est pratiquement inutile</li>
</ul></li>
<li><p><strong>Fraude bancaire: Modèle A</strong></p>
<ul>
<li>AUC élevé = meilleure discrimination</li>
<li>Important car coûts élevés (fraudes manquées + fausses alarmes)</li>
<li>Permet de choisir le seuil optimal selon les coûts métier</li>
</ul></li>
<li><p><strong>Utilité de C:</strong></p>
<ul>
<li>Pratiquement aucune (performance aléatoire)</li>
<li>Pourrait indiquer un problème (bug, labels inversés, features non pertinentes)</li>
<li>Si AUC &lt; 0.5: inverser les prédictions pourrait aider!</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="choix-de-métriques-selon-le-contexte" class="level2">
<h2 class="anchored" data-anchor-id="choix-de-métriques-selon-le-contexte">4. Choix de Métriques selon le Contexte</h2>
<section id="tableau-de-décision" class="level3">
<h3 class="anchored" data-anchor-id="tableau-de-décision">4.1 Tableau de Décision</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 50%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Contexte</th>
<th>Métrique Principale</th>
<th>Raison</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Détection de spam</strong></td>
<td>Precision</td>
<td>Éviter de perdre emails importants (FP coûteux)</td>
</tr>
<tr class="even">
<td><strong>Détection de cancer</strong></td>
<td>Recall</td>
<td>Ne manquer aucun malade (FN critique)</td>
</tr>
<tr class="odd">
<td><strong>Moteur de recherche</strong></td>
<td>Precision@K</td>
<td>Premiers résultats doivent être pertinents</td>
</tr>
<tr class="even">
<td><strong>Fraude bancaire</strong></td>
<td>F1 ou AUC</td>
<td>Équilibre entre détecter fraudes et éviter fausses alarmes</td>
</tr>
<tr class="odd">
<td><strong>Système de recommandation</strong></td>
<td>Precision</td>
<td>Recommandations doivent être pertinentes</td>
</tr>
<tr class="even">
<td><strong>Détection d’intrusion réseau</strong></td>
<td>Recall</td>
<td>Ne rater aucune attaque (FN dangereux)</td>
</tr>
<tr class="odd">
<td><strong>Diagnostic automatisé</strong></td>
<td>Recall + Precision</td>
<td>Les deux sont importants (vies humaines)</td>
</tr>
</tbody>
</table>
</section>
<section id="classes-déséquilibrées" class="level3">
<h3 class="anchored" data-anchor-id="classes-déséquilibrées">4.2 Classes Déséquilibrées</h3>
<p>Lorsque les classes sont <strong>très déséquilibrées</strong> (ex: 1% positifs, 99% négatifs):</p>
<p><strong>❌ À ÉVITER:</strong></p>
<ul>
<li>Accuracy (trompeuse)</li>
</ul>
<p><strong>✅ À UTILISER:</strong></p>
<ul>
<li>Precision, Recall, F1-Score</li>
<li>AUC-ROC</li>
<li>Precision-Recall curve</li>
<li>Balanced Accuracy = <span class="math inline">\(\frac{\text{Recall} + \text{Specificity}}{2}\)</span></li>
</ul>
<div id="73ea640c" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> balanced_accuracy_score</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy normale (biaisée si déséquilibre)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>acc <span class="op">=</span> accuracy_score(y_true, y_pred)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Balanced accuracy (moyenne de recall et specificity)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>balanced_acc <span class="op">=</span> balanced_accuracy_score(y_true, y_pred)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>acc<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Balanced Accuracy: </span><span class="sc">{</span>balanced_acc<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="exercice-4.1-choix-de-métrique" class="level3">
<h3 class="anchored" data-anchor-id="exercice-4.1-choix-de-métrique">Exercice 4.1: Choix de Métrique</h3>
<p>Pour chaque scénario, choisissez la métrique la plus appropriée et justifiez:</p>
<ol type="1">
<li><strong>Système de reconnaissance faciale pour déverrouillage de téléphone</strong></li>
<li><strong>Filtre anti-spam Gmail</strong></li>
<li><strong>Détection de COVID-19 par test rapide</strong></li>
<li><strong>Système de recommandation Netflix</strong></li>
<li><strong>Détection de transactions frauduleuses (0.1% de fraudes)</strong></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution Exercice 4.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>1. Reconnaissance faciale pour téléphone:</strong> - <strong>Métrique</strong>: <strong>Precision</strong> (prioritaire) + FPR faible - <strong>Justification</strong>:</p>
<ul>
<li>FP = Personne non autorisée accède au téléphone (GRAVE - sécurité)</li>
<li>FN = Propriétaire doit retenter (MINEUR - inconvénient)</li>
<li>Mieux vaut bloquer le propriétaire parfois que laisser entrer un intrus</li>
</ul>
<p><strong>2. Filtre anti-spam Gmail:</strong></p>
<ul>
<li><p><strong>Métrique</strong>: <strong>Precision</strong> (prioritaire)</p></li>
<li><p><strong>Justification</strong>:</p>
<ul>
<li>FP = Email important dans spam (GRAVE - peut manquer info critique)</li>
<li>FN = Spam en boîte de réception (MINEUR - simple nuisance)</li>
<li>Gmail préfère laisser passer du spam que bloquer des emails légitimes</li>
</ul></li>
</ul>
<p><strong>3. Détection COVID-19:</strong></p>
<ul>
<li><strong>Métrique</strong>: <strong>Recall</strong> (prioritaire)</li>
<li><strong>Justification</strong>:
<ul>
<li>FN = Malade non détecté → propage le virus (GRAVE - santé publique)</li>
<li>FP = Personne saine isolée inutilement (MINEUR - test confirmatoire possible)</li>
<li>Mieux vaut trop détecter que pas assez</li>
</ul></li>
</ul>
<p><strong>4. Recommandation Netflix:</strong></p>
<ul>
<li><strong>Métrique</strong>: <strong>Precision@K</strong> (K = nombre de recommandations affichées)</li>
<li><strong>Justification</strong>:
<ul>
<li>Utilisateur voit seulement les K premières recommandations</li>
<li>Celles-ci doivent être pertinentes pour satisfaction client</li>
<li>Recall moins important (on ne peut pas tout recommander)</li>
</ul></li>
</ul>
<p><strong>5. Fraude bancaire (0.1% de fraudes):</strong></p>
<ul>
<li><p><strong>Métriques</strong>: <strong>F1-Score</strong> + <strong>AUC-ROC</strong> + <strong>Precision-Recall curve</strong></p></li>
<li><p><strong>Justification</strong>:</p>
<ul>
<li>Classes très déséquilibrées → Accuracy inutile</li>
<li>FP = Client bloqué à tort (coûteux - insatisfaction)</li>
<li>FN = Fraude non détectée (très coûteux - pertes financières)</li>
<li>Besoin d’équilibre → F1 ou optimiser selon coûts métier</li>
<li>AUC pour comparer modèles indépendamment du seuil</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="exercice-récapitulatif-complet" class="level2">
<h2 class="anchored" data-anchor-id="exercice-récapitulatif-complet">5. Exercice Récapitulatif Complet</h2>
<section id="scénario-détecteur-de-défauts-en-usine" class="level3">
<h3 class="anchored" data-anchor-id="scénario-détecteur-de-défauts-en-usine">Scénario: Détecteur de Défauts en Usine</h3>
<p>Une usine produit 10,000 pièces par jour. En moyenne, 100 pièces (1%) sont défectueuses.</p>
<p>Vous avez développé un modèle de détection automatique qui donne les résultats suivants sur 1000 pièces de test:</p>
<pre><code>              Prédiction
           OK    Défectueux
Réalité OK    970      20
     Défect.   3       7</code></pre>
<p><strong>Coûts:</strong></p>
<ul>
<li>Pièce défectueuse non détectée (FN): <strong>500€</strong> (vendue puis retournée par client)</li>
<li>Pièce OK rejetée à tort (FP): <strong>10€</strong> (inspection manuelle inutile)</li>
<li>Inspection manuelle d’une pièce: <strong>5€</strong></li>
</ul>
<p><strong>Questions:</strong></p>
<ol type="1">
<li>Calculez toutes les métriques (Accuracy, Precision, Recall, F1, Specificity)</li>
<li>Le modèle est-il acceptable d’un point de vue métier?</li>
<li>Calculez le coût total journalier des erreurs</li>
<li>Quelle métrique devriez-vous optimiser en priorité?</li>
<li>Proposez une amélioration du modèle</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution Exercice Récapitulatif
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="2a18a366" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#           OK    Défect</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># OK       970      20</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Défect     3       7</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>tn, fp <span class="op">=</span> <span class="dv">970</span>, <span class="dv">20</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>fn, tp <span class="op">=</span> <span class="dv">3</span>, <span class="dv">7</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> tn <span class="op">+</span> fp <span class="op">+</span> fn <span class="op">+</span> tp</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANALYSE DU DÉTECTEUR DE DÉFAUTS"</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Métriques</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. MÉTRIQUES DE PERFORMANCE:"</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> total</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (precision <span class="op">*</span> recall) <span class="op">/</span> (precision <span class="op">+</span> recall)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>specificity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>fpr <span class="op">=</span> fp <span class="op">/</span> (fp <span class="op">+</span> tn)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>fnr <span class="op">=</span> fn <span class="op">/</span> (fn <span class="op">+</span> tp)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> {</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>: accuracy,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>: precision,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>: recall,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1-Score'</span>: f1,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Specificity'</span>: specificity,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'False Positive Rate'</span>: fpr,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'False Negative Rate'</span>: fnr</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> metrics.items():</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>metric<span class="sc">:25s}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>value<span class="op">*</span><span class="dv">100</span><span class="sc">:6.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Acceptabilité métier</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. ACCEPTABILITÉ MÉTIER:"</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"X Recall = </span><span class="sc">{</span>recall<span class="sc">:.2%}</span><span class="ss"> est TRÈS FAIBLE"</span>)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Sur 10 défauts, seulement </span><span class="sc">{</span>tp<span class="sc">}</span><span class="ss"> détectés, </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> manqués!"</span>)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → </span><span class="sc">{</span>fnr<span class="sc">:.2%}</span><span class="ss"> de défauts passent inaperçus"</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">$</span><span class="er">\</span><span class="ss">checkmark$ Precision = </span><span class="sc">{</span>precision<span class="sc">:.2%}</span><span class="ss"> est acceptable"</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Peu de fausses alarmes"</span>)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">X CONCLUSION: Modèle INACCEPTABLE"</span>)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Trop de défauts non détectés atteignent les clients"</span>)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Coût journalier</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. COÛT TOTAL JOURNALIER:"</span>)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrapolation à 10,000 pièces</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>total_pieces <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>defect_rate <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>total_defects <span class="op">=</span> <span class="bu">int</span>(total_pieces <span class="op">*</span> defect_rate)  <span class="co"># 100 défauts</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>total_ok <span class="op">=</span> total_pieces <span class="op">-</span> total_defects  <span class="co"># 9900 OK</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des erreurs attendues</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>expected_fn <span class="op">=</span> <span class="bu">int</span>(total_defects <span class="op">*</span> fnr)  <span class="co"># Défauts non détectés</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>expected_fp <span class="op">=</span> <span class="bu">int</span>(total_ok <span class="op">*</span> fpr)  <span class="co"># OK rejetés à tort</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>cout_fn <span class="op">=</span> expected_fn <span class="op">*</span> <span class="dv">500</span>  <span class="co"># Défauts non détectés</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>cout_fp <span class="op">=</span> expected_fp <span class="op">*</span> <span class="dv">10</span>   <span class="co"># OK rejetés</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>cout_inspection <span class="op">=</span> (expected_fn <span class="op">+</span> expected_fp) <span class="op">*</span> <span class="dv">0</span>  <span class="co"># Pas d'inspection pour erreurs</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>cout_total <span class="op">=</span> cout_fn <span class="op">+</span> cout_fp</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Production journalière:     </span><span class="sc">{</span>total_pieces<span class="sc">:,}</span><span class="ss"> pièces"</span>)</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Défauts réels:              </span><span class="sc">{</span>total_defects<span class="sc">}</span><span class="ss"> pièces (</span><span class="sc">{</span>defect_rate<span class="sc">:.1%}</span><span class="ss">)"</span>)</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Erreurs attendues:"</span>)</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - FN (défauts manqués):   </span><span class="sc">{</span>expected_fn<span class="sc">}</span><span class="ss"> × 500€ = </span><span class="sc">{</span>cout_fn<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - FP (OK rejetés):        </span><span class="sc">{</span>expected_fp<span class="sc">}</span><span class="ss"> × 10€  = </span><span class="sc">{</span>cout_fp<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Coût total des erreurs:     </span><span class="sc">{</span>cout_total<span class="sc">:,}</span><span class="ss">€/jour"</span>)</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Coût mensuel (22 jours):    </span><span class="sc">{</span>cout_total<span class="op">*</span><span class="dv">22</span><span class="sc">:,}</span><span class="ss">€/mois"</span>)</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Coût annuel (250 jours):    </span><span class="sc">{</span>cout_total<span class="op">*</span><span class="dv">250</span><span class="sc">:,}</span><span class="ss">€/an"</span>)</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Métrique à optimiser</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. MÉTRIQUE À OPTIMISER:"</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"→ RECALL (priorité absolue)"</span>)</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Raison: Le coût d'un FN (500€) est 50× plus élevé"</span>)</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"        que le coût d'un FP (10€)"</span>)</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Ratio coût FN/FP: </span><span class="sc">{</span><span class="dv">500</span><span class="op">/</span><span class="dv">10</span><span class="sc">:.0f}</span><span class="ss">:1"</span>)</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Stratégie: Maximiser le Recall, même au prix de"</span>)</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"           la Precision (plus de fausses alarmes acceptable)"</span>)</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Amélioration</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">5. PROPOSITIONS D'AMÉLIORATION:"</span>)</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">A. Court terme (ajustement du seuil):"</span>)</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Abaisser le seuil de décision (ex: 0.5 → 0.2)"</span>)</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Objectif: Recall &gt; 90%"</span>)</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Conséquence: Plus de FP (mais coût acceptable)"</span>)</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation avec recall amélioré</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>recall_target <span class="op">=</span> <span class="fl">0.90</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>fn_new <span class="op">=</span> <span class="bu">int</span>(total_defects <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> recall_target))  <span class="co"># 10 défauts manqués</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Supposons que Precision baisse à 20%</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>precision_new <span class="op">=</span> <span class="fl">0.20</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>fp_new <span class="op">=</span> <span class="bu">int</span>((total_defects <span class="op">*</span> recall_target) <span class="op">/</span> precision_new <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> precision_new))</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>cout_fn_new <span class="op">=</span> fn_new <span class="op">*</span> <span class="dv">500</span></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>cout_fp_new <span class="op">=</span> fp_new <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>cout_total_new <span class="op">=</span> cout_fn_new <span class="op">+</span> cout_fp_new</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Simulation avec Recall=90%, Precision=20%:"</span>)</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - FN: </span><span class="sc">{</span>fn_new<span class="sc">}</span><span class="ss"> × 500€ = </span><span class="sc">{</span>cout_fn_new<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - FP: </span><span class="sc">{</span>fp_new<span class="sc">}</span><span class="ss"> × 10€ = </span><span class="sc">{</span>cout_fp_new<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Coût total: </span><span class="sc">{</span>cout_total_new<span class="sc">:,}</span><span class="ss">€/jour"</span>)</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Économie: </span><span class="sc">{</span>cout_total <span class="op">-</span> cout_total_new<span class="sc">:,}</span><span class="ss">€/jour"</span>)</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - ROI annuel: </span><span class="sc">{</span>(cout_total <span class="op">-</span> cout_total_new)<span class="op">*</span><span class="dv">250</span><span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">B. Moyen terme (amélioration du modèle):"</span>)</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Collecter plus de données (surtout défauts)"</span>)</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Feature engineering (nouvelles caractéristiques)"</span>)</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Essayer d'autres algorithmes (XGBoost, CNN)"</span>)</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   4. Data augmentation pour la classe minoritaire"</span>)</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">C. Long terme (approche hybride):"</span>)</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Modèle ML comme premier filtre (Recall élevé)"</span>)</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Inspection manuelle des cas suspects"</span>)</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Double vérification pour cas limites"</span>)</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> np.array([[tn, fp], [fn, tp]])</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>],</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>            xticklabels<span class="op">=</span>[<span class="st">'OK'</span>, <span class="st">'Défectueux'</span>],</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>[<span class="st">'OK'</span>, <span class="st">'Défectueux'</span>])</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Vraie Classe'</span>)</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Prédiction'</span>)</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Matrice de Confusion'</span>)</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison coûts</span></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>scenarios <span class="op">=</span> [<span class="st">'Modèle Actuel</span><span class="ch">\n</span><span class="st">(Recall=70%)'</span>, </span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>             <span class="st">'Modèle Amélioré</span><span class="ch">\n</span><span class="st">(Recall=90%)'</span>]</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>couts <span class="op">=</span> [cout_total, cout_total_new]</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#ff6b6b'</span>, <span class="st">'#51cf66'</span>]</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].bar(scenarios, couts, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Coût journalier (€)'</span>)</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Comparaison des Coûts'</span>)</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (scenario, cout) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(scenarios, couts)):</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text(i, cout <span class="op">+</span> <span class="dv">100</span>, <span class="ss">f'</span><span class="sc">{</span>cout<span class="sc">:,}</span><span class="ss">€'</span>, </span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau récapitulatif</span></span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLEAU RÉCAPITULATIF"</span>)</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Métrique'</span>: [<span class="st">'Recall'</span>, <span class="st">'Precision'</span>, <span class="st">'FN/jour'</span>, <span class="st">'FP/jour'</span>, <span class="st">'Coût/jour'</span>],</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Actuel'</span>: [<span class="ss">f'</span><span class="sc">{</span>recall<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>precision<span class="sc">:.1%}</span><span class="ss">'</span>, expected_fn, expected_fp, <span class="ss">f'</span><span class="sc">{</span>cout_total<span class="sc">:,}</span><span class="ss">€'</span>],</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Cible'</span>: [<span class="st">'90%'</span>, <span class="st">'20%'</span>, fn_new, fp_new, <span class="ss">f'</span><span class="sc">{</span>cout_total_new<span class="sc">:,}</span><span class="ss">€'</span>],</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Amélioration'</span>: [<span class="st">'↑ +20pp'</span>, <span class="st">'↓ -6pp'</span>, <span class="ss">f'↓ -</span><span class="sc">{</span>expected_fn<span class="op">-</span>fn_new<span class="sc">}</span><span class="ss">'</span>, <span class="ss">f'↑ +</span><span class="sc">{</span>fp_new<span class="op">-</span>expected_fp<span class="sc">}</span><span class="ss">'</span>, </span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>                     <span class="ss">f'↓ -</span><span class="sc">{</span>cout_total<span class="op">-</span>cout_total_new<span class="sc">:,}</span><span class="ss">€'</span>]</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Synthèse des réponses:</strong></p>
<p><strong>1. Métriques:</strong></p>
<ul>
<li>Accuracy: 97.70%</li>
<li>Precision: 25.93% (7 sur 27 prédictions de défauts sont correctes)</li>
<li>Recall: 70.00% (7 sur 10 vrais défauts détectés)</li>
<li>F1-Score: 38.89%</li>
<li>Specificity: 97.98%</li>
</ul>
<p><strong>2. Acceptabilité métier:</strong></p>
<ul>
<li>❌ <strong>NON ACCEPTABLE</strong></li>
<li>Recall de 70% signifie 30% de défauts non détectés</li>
<li>Ces défauts atteignent les clients → réputation + coûts</li>
</ul>
<p><strong>3. Coût journalier:</strong></p>
<ul>
<li>FN: 30 défauts × 500€ = <strong>15,000€/jour</strong></li>
<li>FP: 200 pièces × 10€ = <strong>2,000€/jour</strong></li>
<li><strong>Total: 17,000€/jour</strong> (<span class="math inline">\(\approx\)</span> 4.25M€/an!)</li>
</ul>
<p><strong>4. Métrique à optimiser:</strong></p>
<ul>
<li><strong>RECALL</strong> (priorité absolue)</li>
<li>Ratio coût 50:1 en faveur de l’augmentation du Recall</li>
<li>Accepter plus de FP pour réduire FN</li>
</ul>
<p><strong>5. Amélioration proposée:</strong></p>
<ul>
<li>Abaisser seuil → Recall 90%+</li>
<li>Économie potentielle: ~10,000€/jour</li>
<li>ROI annuel: ~2.5M€</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="comparaison-critique-des-résultats" class="level2">
<h2 class="anchored" data-anchor-id="comparaison-critique-des-résultats">6. Comparaison Critique des Résultats</h2>
<section id="exercice-6.1-analyse-comparative" class="level3">
<h3 class="anchored" data-anchor-id="exercice-6.1-analyse-comparative">Exercice 6.1: Analyse Comparative</h3>
<p>Trois data scientists ont entraîné des modèles pour détecter des défaillances machines:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Modèle</th>
<th>Accuracy</th>
<th>Precision</th>
<th>Recall</th>
<th>F1</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>98%</td>
<td>40%</td>
<td>95%</td>
<td>56%</td>
<td>0.92</td>
</tr>
<tr class="even">
<td>B</td>
<td>95%</td>
<td>80%</td>
<td>70%</td>
<td>75%</td>
<td>0.88</td>
</tr>
<tr class="odd">
<td>C</td>
<td>99%</td>
<td>20%</td>
<td>60%</td>
<td>30%</td>
<td>0.75</td>
</tr>
</tbody>
</table>
<p><strong>Contexte:</strong> 2% de défaillances, coût FN = 10,000€, coût FP = 100€</p>
<p><strong>Questions:</strong></p>
<ol type="1">
<li>Quel modèle recommandez-vous?</li>
<li>Justifiez votre choix avec calculs de coûts</li>
<li>Que révèle l’Accuracy élevée du modèle C?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution Exercice 6.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="9330ea5b" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>models_data <span class="op">=</span> {</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Modèle'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>: [<span class="fl">0.98</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>: [<span class="fl">0.40</span>, <span class="fl">0.80</span>, <span class="fl">0.20</span>],</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>: [<span class="fl">0.95</span>, <span class="fl">0.70</span>, <span class="fl">0.60</span>],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>: [<span class="fl">0.56</span>, <span class="fl">0.75</span>, <span class="fl">0.30</span>],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AUC'</span>: [<span class="fl">0.92</span>, <span class="fl">0.88</span>, <span class="fl">0.75</span>]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>df_models <span class="op">=</span> pd.DataFrame(models_data)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Contexte</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>defect_rate <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>total_samples <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>total_defects <span class="op">=</span> <span class="bu">int</span>(total_samples <span class="op">*</span> defect_rate)  <span class="co"># 200</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>total_normal <span class="op">=</span> total_samples <span class="op">-</span> total_defects  <span class="co"># 9800</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>cost_fn <span class="op">=</span> <span class="dv">10000</span>  <span class="co"># Coût défaillance non détectée</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>cost_fp <span class="op">=</span> <span class="dv">100</span>    <span class="co"># Coût fausse alarme</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANALYSE COMPARATIVE DES MODÈLES"</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des coûts pour chaque modèle</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df_models.iterrows():</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> row[<span class="st">'Modèle'</span>]</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> row[<span class="st">'Recall'</span>]</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> row[<span class="st">'Precision'</span>]</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul des erreurs</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    fn <span class="op">=</span> <span class="bu">int</span>(total_defects <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> recall))  <span class="co"># Défauts manqués</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> total_defects <span class="op">-</span> fn  <span class="co"># Défauts détectés</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># De precision = TP / (TP + FP), on déduit FP</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> precision <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>        fp <span class="op">=</span> <span class="bu">int</span>(tp <span class="op">/</span> precision <span class="op">-</span> tp)  <span class="co"># Fausses alarmes</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>        fp <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coûts</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    cost_fn_total <span class="op">=</span> fn <span class="op">*</span> cost_fn</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    cost_fp_total <span class="op">=</span> fp <span class="op">*</span> cost_fp</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    cost_total <span class="op">=</span> cost_fn_total <span class="op">+</span> cost_fp_total</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Modèle'</span>: model,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">'FN'</span>: fn,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">'FP'</span>: fp,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coût FN'</span>: cost_fn_total,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coût FP'</span>: cost_fp_total,</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coût Total'</span>: cost_total</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Modèle </span><span class="sc">{</span>model<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Recall: </span><span class="sc">{</span>recall<span class="sc">:.0%}</span><span class="ss"> → FN = </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> défaillances manquées"</span>)</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Precision: </span><span class="sc">{</span>precision<span class="sc">:.0%}</span><span class="ss"> → FP = </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss"> fausses alarmes"</span>)</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Coût FN: </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> × </span><span class="sc">{</span>cost_fn<span class="sc">:,}</span><span class="ss">€ = </span><span class="sc">{</span>cost_fn_total<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Coût FP: </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss"> × </span><span class="sc">{</span>cost_fp<span class="sc">:,}</span><span class="ss">€ = </span><span class="sc">{</span>cost_fp_total<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  COÛT TOTAL: </span><span class="sc">{</span>cost_total<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Meilleur modèle</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>best_model <span class="op">=</span> df_results.loc[df_results[<span class="st">'Coût Total'</span>].idxmin()]</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RECOMMANDATION"</span>)</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"→ Modèle </span><span class="sc">{</span>best_model[<span class="st">'Modèle'</span>]<span class="sc">}</span><span class="ss"> (coût le plus faible)"</span>)</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Justification:"</span>)</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Coût total minimal: </span><span class="sc">{</span>best_model[<span class="st">'Coût Total'</span>]<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Recall élevé (</span><span class="sc">{</span>df_models[df_models[<span class="st">'Modèle'</span>]<span class="op">==</span>best_model[<span class="st">'Modèle'</span>]][<span class="st">'Recall'</span>]<span class="sc">.</span>values[<span class="dv">0</span>]<span class="sc">:.0%}</span><span class="ss">) critique car FN très coûteux"</span>)</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Le surcoût en FP est négligeable comparé aux économies en FN"</span>)</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANALYSE DU MODÈLE C"</span>)</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy de 99% mais performances médiocres:"</span>)</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  → Piège des classes déséquilibrées!"</span>)</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Avec 2% de défauts, prédire 'normal' partout"</span>)</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     donnerait déjà 98% d'accuracy"</span>)</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  → Recall de 60% = 40</span><span class="sc">% d</span><span class="st">e défauts manqués (inacceptable)"</span>)</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  → AUC faible (0.75) confirme faible capacité discriminative"</span>)</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">  Conclusion: Accuracy est une métrique TROMPEUSE ici!"</span>)</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisations</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique 1: Comparaison des coûts</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_results[<span class="st">'Modèle'</span>]</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>x_pos <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(x))</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar([p <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> p <span class="kw">in</span> x_pos], df_results[<span class="st">'Coût FN'</span>], </span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>           width, label<span class="op">=</span><span class="st">'Coût FN'</span>, color<span class="op">=</span><span class="st">'#ff6b6b'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar([p <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> p <span class="kw">in</span> x_pos], df_results[<span class="st">'Coût FP'</span>], </span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>           width, label<span class="op">=</span><span class="st">'Coût FP'</span>, color<span class="op">=</span><span class="st">'#ffa94d'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Modèle'</span>)</span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Coût (€)'</span>)</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Comparaison des Coûts par Type d</span><span class="ch">\'</span><span class="st">Erreur'</span>)</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(x_pos)</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(x)</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter coût total</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (idx, row) <span class="kw">in</span> <span class="bu">enumerate</span>(df_results.iterrows()):</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> row[<span class="st">'Coût Total'</span>]</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].text(i, total <span class="op">+</span> <span class="dv">5000</span>, <span class="ss">f'</span><span class="sc">{</span>total<span class="sc">:,}</span><span class="ss">€'</span>, </span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique 2: Radar chart des métriques</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1'</span>, <span class="st">'AUC'</span>]</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(categories)</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>angles <span class="op">=</span> [n <span class="op">/</span> <span class="bu">float</span>(N) <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> pi <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>angles <span class="op">+=</span> angles[:<span class="dv">1</span>]</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">122</span>, projection<span class="op">=</span><span class="st">'polar'</span>)</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df_models.iterrows():</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> [row[<span class="st">'Accuracy'</span>], row[<span class="st">'Precision'</span>], row[<span class="st">'Recall'</span>], </span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>              row[<span class="st">'F1'</span>], row[<span class="st">'AUC'</span>]]</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>    values <span class="op">+=</span> values[:<span class="dv">1</span>]</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>    ax.plot(angles, values, <span class="st">'o-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f"Modèle </span><span class="sc">{</span>row[<span class="st">'Modèle'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>    ax.fill(angles, values, alpha<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(angles[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(categories)</span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Comparaison Multidimensionnelle des Métriques'</span>, y<span class="op">=</span><span class="fl">1.08</span>)</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.3</span>, <span class="fl">1.1</span>))</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau final</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLEAU RÉCAPITULATIF"</span>)</span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_results.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Réponses:</strong></p>
<ol type="1">
<li><p><strong>Modèle recommandé: A</strong></p></li>
<li><p><strong>Justification avec coûts:</strong></p>
<ul>
<li>Modèle A: 10 FN × 10,000€ + 475 FP × 100€ = <strong>147,500€</strong></li>
<li>Modèle B: 60 FN × 10,000€ + 175 FP × 100€ = <strong>617,500€</strong></li>
<li>Modèle C: 80 FN × 10,000€ + 600 FP × 100€ = <strong>860,000€</strong></li>
</ul>
<p>Le Modèle A minimise le coût total malgré plus de FP</p></li>
<li><p><strong>Accuracy élevée du Modèle C:</strong></p>
<ul>
<li>Piège classique des classes déséquilibrées!</li>
<li>99% accuracy car prédit surtout “normal”</li>
<li>Mais rate 40% des défaillances (Recall = 60%)</li>
<li><strong>Leçon</strong>: Accuracy seule est trompeuse avec déséquilibre</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="résumé-de-la-séance" class="level2">
<h2 class="anchored" data-anchor-id="résumé-de-la-séance">Résumé de la Séance</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Points clés à retenir
</div>
</div>
<div class="callout-body-container callout-body">
<section id="matrice-de-confusion" class="level3">
<h3 class="anchored" data-anchor-id="matrice-de-confusion">1. Matrice de Confusion</h3>
<ul>
<li>Fondation de toutes les métriques</li>
<li>TP, TN, FP, FN à bien comprendre</li>
<li>Visualisation claire des erreurs</li>
</ul>
</section>
<section id="métriques-principales" class="level3">
<h3 class="anchored" data-anchor-id="métriques-principales">2. Métriques Principales</h3>
<ul>
<li><strong>Accuracy</strong>: % correct (attention au déséquilibre!)</li>
<li><strong>Precision</strong>: Fiabilité des prédictions positives</li>
<li><strong>Recall</strong>: Couverture des vrais positifs</li>
<li><strong>F1-Score</strong>: Équilibre Precision-Recall</li>
</ul>
</section>
<section id="compromis" class="level3">
<h3 class="anchored" data-anchor-id="compromis">3. Compromis</h3>
<ul>
<li>Precision ↑ → Recall ↓ (généralement)</li>
<li>Choix selon le coût des erreurs</li>
<li>Ajustement du seuil de décision</li>
</ul>
</section>
<section id="courbe-roc-et-auc-1" class="level3">
<h3 class="anchored" data-anchor-id="courbe-roc-et-auc-1">4. Courbe ROC et AUC</h3>
<ul>
<li>Évaluation indépendante du seuil</li>
<li>AUC = mesure globale de discrimination</li>
<li>Comparaison facile de modèles</li>
</ul>
</section>
<section id="choix-contextuel" class="level3">
<h3 class="anchored" data-anchor-id="choix-contextuel">5. Choix Contextuel</h3>
<ul>
<li><strong>Pas de métrique universelle!</strong></li>
<li>Dépend du problème métier</li>
<li>Considérer les coûts réels des erreurs</li>
<li>Classes déséquilibrées → éviter Accuracy seule</li>
</ul>
</section>
<section id="règles-dor" class="level3">
<h3 class="anchored" data-anchor-id="règles-dor">6. Règles d’Or</h3>
<ol type="1">
<li>Toujours regarder plusieurs métriques</li>
<li>Privilégier Recall si FN coûteux</li>
<li>Privilégier Precision si FP coûteux</li>
<li>Utiliser AUC pour comparer modèles</li>
<li>Valider avec coûts métier réels</li>
</ol>
</section>
</div>
</div>
</section>
<section id="checklist-de-maîtrise" class="level2">
<h2 class="anchored" data-anchor-id="checklist-de-maîtrise">Checklist de Maîtrise</h2>
<ul class="task-list">
<li><label><input type="checkbox">Je sais construire et interpréter une matrice de confusion</label></li>
<li><label><input type="checkbox">Je comprends la différence entre Precision et Recall</label></li>
<li><label><input type="checkbox">Je peux expliquer pourquoi Accuracy peut être trompeuse</label></li>
<li><label><input type="checkbox">Je sais calculer manuellement les métriques de base</label></li>
<li><label><input type="checkbox">Je comprends le compromis Precision-Recall</label></li>
<li><label><input type="checkbox">Je sais interpréter une courbe ROC et l’AUC</label></li>
<li><label><input type="checkbox">Je peux choisir la métrique appropriée selon le contexte</label></li>
<li><label><input type="checkbox">Je comprends l’impact des classes déséquilibrées</label></li>
</ul>
</section>
<section id="exercices-supplémentaires" class="level2">
<h2 class="anchored" data-anchor-id="exercices-supplémentaires">Exercices Supplémentaires</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Pour s’entraîner
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Implémentez</strong> toutes les métriques vues en Python sans Scikit-learn</li>
<li><strong>Créez</strong> une fonction qui recommande la meilleure métrique selon le contexte</li>
<li><strong>Analysez</strong> un dataset déséquilibré (ex: fraude, maladie rare) sur Kaggle</li>
<li><strong>Comparez</strong> plusieurs modèles sur le même problème avec toutes les métriques</li>
<li><strong>Explorez</strong> l’effet du seuil de décision sur Precision et Recall</li>
</ol>
</div>
</div>
</section>
<section id="préparation-séance-suivante" class="level2">
<h2 class="anchored" data-anchor-id="préparation-séance-suivante">Préparation Séance Suivante</h2>
<p>La <strong>Séance 6 (TP2)</strong> abordera:</p>
<ul>
<li>Classification multi-classes</li>
<li>Optimisation d’hyperparamètres (GridSearchCV, RandomizedSearchCV)</li>
<li>Validation croisée</li>
<li>Comparaison avancée de modèles</li>
</ul>
<p><strong>À préparer:</strong></p>
<ul>
<li>Relire les concepts de validation croisée</li>
<li>Installer scikit-learn à jour</li>
<li>Réfléchir aux hyperparamètres importants de chaque algorithme</li>
</ul>
</section>
<section id="ressources-complémentaires" class="level2">
<h2 class="anchored" data-anchor-id="ressources-complémentaires">Ressources Complémentaires</h2>
<ol type="1">
<li><a href="https://scikit-learn.org/stable/modules/model_evaluation.html">Scikit-learn: Model Evaluation</a></li>
<li><a href="https://developers.google.com/machine-learning/crash-course/classification">Google ML Crash Course: Classification</a></li>
<li><a href="https://www.youtube.com/watch?v=vP06aMoz4v8">StatQuest: Sensitivity and Specificity</a></li>
<li><a href="https://towardsdatascience.com/beyond-accuracy-precision-and-recall-3da06bea9f6c">Towards Data Science: Beyond Accuracy</a></li>
</ol>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/nevermind78\.github\.io\/Ml_DL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./seance4.html" class="pagination-link" aria-label="Séance 4: TD1 - Modèles de Classification de Base">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Séance 4: TD1 - Modèles de Classification de Base</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./seance6.html" class="pagination-link" aria-label="Séance 6: TP2 - Classification Multi-classes &amp; Optimisation">
        <span class="nav-page-text"><span class="chapter-title">Séance 6: TP2 - Classification Multi-classes &amp; Optimisation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Séance 5: TD2 - Critères d'Évaluation</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">## Informations de la séance</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Type**: Travaux Dirigés</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Durée**: 2h</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Objectifs**: Obj4</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>L'évaluation correcte d'un modèle de classification est cruciale. Choisir la mauvaise métrique peut conduire à des conclusions erronées et à des modèles inadaptés en production. Dans ce TD, nous allons explorer en profondeur les différentes métriques d'évaluation.</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. La Matrice de Confusion</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1 Définition et Structure</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>La **matrice de confusion** est un tableau qui visualise les performances d'un modèle de classification en comparant les prédictions aux vraies valeurs.</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>Pour un problème **binaire**:</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="in">                    Prédiction</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="in">                 Négatif  Positif</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="in">Réalité  Négatif    TN       FP</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="in">         Positif    FN       TP</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>Où:</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**TP (True Positive)**: Vrais Positifs - correctement classifiés comme positifs</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**TN (True Negative)**: Vrais Négatifs - correctement classifiés comme négatifs</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**FP (False Positive)**: Faux Positifs - incorrectement classifiés comme positifs (Erreur Type I)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**FN (False Negative)**: Faux Négatifs - incorrectement classifiés comme négatifs (Erreur Type II)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mnémotechnique</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Type I (FP)**: Fausse alarme - "On crie au loup alors qu'il n'y a pas de loup"</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Type II (FN)**: Manque - "On ne voit pas le loup alors qu'il est là"</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.2 Exemple Concret: Détection de Maladie</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>Considérez un test médical pour une maladie:</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Patient <span class="pp">|</span> Vraie Classe <span class="pp">|</span> Prédiction <span class="pp">|</span> Résultat <span class="pp">|</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|--------------|------------|----------|</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1 <span class="pp">|</span> Malade <span class="pp">|</span> Malade <span class="pp">|</span> TP $\checkmark$ <span class="pp">|</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 <span class="pp">|</span> Malade <span class="pp">|</span> Sain <span class="pp">|</span> FN X (Dangereux!) <span class="pp">|</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3 <span class="pp">|</span> Sain <span class="pp">|</span> Malade <span class="pp">|</span> FP X (Fausse alarme) <span class="pp">|</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4 <span class="pp">|</span> Sain <span class="pp">|</span> Sain <span class="pp">|</span> TN $\checkmark$ <span class="pp">|</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5 <span class="pp">|</span> Malade <span class="pp">|</span> Malade <span class="pp">|</span> TP $\checkmark$ <span class="pp">|</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 6 <span class="pp">|</span> Sain <span class="pp">|</span> Sain <span class="pp">|</span> TN $\checkmark$ <span class="pp">|</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 7 <span class="pp">|</span> Malade <span class="pp">|</span> Sain <span class="pp">|</span> FN X (Dangereux!) <span class="pp">|</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 8 <span class="pp">|</span> Sain <span class="pp">|</span> Malade <span class="pp">|</span> FP X (Fausse alarme) <span class="pp">|</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>Matrice de confusion:</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="in">              Prédiction</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="in">           Sain  Malade</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="in">Réalité Sain   2      2      (4 sains)</span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="in">      Malade   2      2      (4 malades)</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**TP = 2**: Malades correctement détectés</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**TN = 2**: Sains correctement identifiés</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**FP = 2**: Sains diagnostiqués malades (traitement inutile)</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**FN = 2**: Malades non détectés (très dangereux!)</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercice 1.1: Construction de Matrice de Confusion</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>Soit les prédictions suivantes pour un détecteur de spam (1 = Spam, 0 = Ham):</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>y_true <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>**Questions:**</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Construisez la matrice de confusion</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculez TP, TN, FP, FN</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Interprétez chaque type d'erreur dans ce contexte</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Exercice 1.1</span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>y_true <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Matrice de confusion</span></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. Matrice de Confusion:"</span>)</span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm)</span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>            xticklabels<span class="op">=</span>[<span class="st">'Ham (0)'</span>, <span class="st">'Spam (1)'</span>],</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>[<span class="st">'Ham (0)'</span>, <span class="st">'Spam (1)'</span>])</span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Vraie Classe'</span>)</span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Prédiction'</span>)</span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matrice de Confusion - Détection de Spam'</span>)</span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calcul manuel</span></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm.ravel()</span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">2. Valeurs:"</span>)</span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TP (Vrais Positifs) = </span><span class="sc">{</span>tp<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TN (Vrais Négatifs) = </span><span class="sc">{</span>tn<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FP (Faux Positifs) = </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FN (Faux Négatifs) = </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification manuelle</span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Interprétation:"</span>)</span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TP = </span><span class="sc">{</span>tp<span class="sc">}</span><span class="ss">: Spams correctement détectés"</span>)</span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TN = </span><span class="sc">{</span>tn<span class="sc">}</span><span class="ss">: Hams correctement identifiés"</span>)</span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FP = </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss">: Hams classés comme spam (vont en indésirables)"</span>)</span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"FN = </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss">: Spams non détectés (arrivent en boîte de réception)"</span>)</span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse détaillée</span></span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Analyse détaillée des prédictions:"</span>)</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (true, pred) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(y_true, y_pred)):</span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a>    status <span class="op">=</span> <span class="st">""</span></span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> true <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"TP $</span><span class="er">\</span><span class="st">checkmark$"</span></span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> true <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"TN $</span><span class="er">\</span><span class="st">checkmark$"</span></span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> true <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"FP X"</span></span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> true <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> pred <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> <span class="st">"FN X"</span></span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>    true_label <span class="op">=</span> <span class="st">"Spam"</span> <span class="cf">if</span> true <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">"Ham"</span></span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a>    pred_label <span class="op">=</span> <span class="st">"Spam"</span> <span class="cf">if</span> pred <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">"Ham"</span></span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Email </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: Vrai=</span><span class="sc">{</span>true_label<span class="sc">}</span><span class="ss">, Prédit=</span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss"> → </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>**Réponses:**</span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Matrice: <span class="in">`[[4, 1], [1, 4]]`</span></span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>TP=4, TN=4, FP=1, FN=1</span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Interprétation:</span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**FP (1 email)**: Email légitime envoyé dans spam (utilisateur peut manquer info importante)</span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**FN (1 email)**: Spam non détecté dans boîte réception (nuisance mineure)</span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Métriques Dérivées</span></span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 Accuracy (Exactitude)</span></span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a>**Définition**: Proportion de prédictions correctes</span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a>$$\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN}$$</span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_true, y_pred)</span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Piège de l'Accuracy!</span></span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a>L'accuracy peut être **trompeuse** avec des classes déséquilibrées!</span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a>**Exemple**: Détection de fraude</span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>990 transactions légitimes, 10 frauduleuses</span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modèle naïf qui prédit toujours "légitime"</span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy = 990/1000 = **99%** </span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mais 0% de fraudes détectées!</span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2 Precision (Précision)</span></span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a>**Définition**: Proportion de prédictions positives qui sont correctes</span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a>$$\text{Precision} = \frac{TP}{TP + FP}$$</span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a>**Question répondue**: "Parmi tous les cas prédits positifs, combien le sont vraiment?"</span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a>**Interprétation**:</span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Haute précision → Peu de faux positifs</span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Important quand le coût d'un FP est élevé</span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_true, y_pred)</span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a>**Exemples où la Precision est cruciale**:</span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Recommandation de produits**: Ne pas recommander des produits non pertinents</span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Filtrage spam**: Ne pas mettre d'emails importants dans spam</span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Détection de visages**: Ne pas identifier de faux visages</span>
<span id="cb19-227"><a href="#cb19-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-228"><a href="#cb19-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3 Recall (Rappel) ou Sensitivity (Sensibilité)</span></span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a>**Définition**: Proportion de vrais positifs correctement identifiés</span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a>$$\text{Recall} = \frac{TP}{TP + FN}$$</span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a>**Question répondue**: "Parmi tous les cas réellement positifs, combien ai-je détectés?"</span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a>**Interprétation**:</span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Haut recall → Peu de faux négatifs</span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Important quand le coût d'un FN est élevé</span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_true, y_pred)</span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a>**Exemples où le Recall est crucial**:</span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Détection de cancer**: Ne manquer aucun malade</span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Détection de fraude**: Détecter toutes les fraudes</span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Systèmes de sécurité**: Ne rater aucune menace</span>
<span id="cb19-259"><a href="#cb19-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-260"><a href="#cb19-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.4 Compromis Precision-Recall</span></span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a>Il existe généralement un **compromis** entre Precision et Recall:</span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a>**Diagramme mermaid :**</span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a>graph LR</span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a>    A[Seuil bas0.<span class="dv">3</span>] --&gt; B[Haute RecallBasse Precision]</span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a>    C[Seuil moyen0.<span class="dv">5</span>] --&gt; D[Équilibre]</span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a>    E[Seuil haut0.<span class="dv">7</span>] --&gt; F[Haute PrecisionBasse Recall]</span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a>**Exemple concret**:</span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de détection de maladie</span></span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Proba patient malade: 0.6</span></span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Seuil = 0.5: Prédit malade → Haute recall</span></span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Seuil = 0.8: Prédit sain → Haute precision (mais manque des cas)</span></span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.5 F1-Score</span></span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a>**Définition**: Moyenne harmonique de Precision et Recall</span>
<span id="cb19-294"><a href="#cb19-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-295"><a href="#cb19-295" aria-hidden="true" tabindex="-1"></a>$$F_1 = 2 \times \frac{\text{Precision} \times \text{Recall}}{\text{Precision} + \text{Recall}}$$</span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a>**Pourquoi moyenne harmonique?**</span>
<span id="cb19-298"><a href="#cb19-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-299"><a href="#cb19-299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pénalise les déséquilibres</span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si Precision=100% et Recall=1%, F1 $\approx$ 2% (pas 50.5%)</span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_true, y_pred)</span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a><span class="co"># ou manuellement:</span></span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (precision <span class="op">*</span> recall) <span class="op">/</span> (precision <span class="op">+</span> recall)</span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-315"><a href="#cb19-315" aria-hidden="true" tabindex="-1"></a>**Quand utiliser F1?**</span>
<span id="cb19-316"><a href="#cb19-316" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Besoin d'équilibre entre Precision et Recall</span>
<span id="cb19-317"><a href="#cb19-317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Classes déséquilibrées</span>
<span id="cb19-318"><a href="#cb19-318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Vouloir une seule métrique résumée</span>
<span id="cb19-319"><a href="#cb19-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-320"><a href="#cb19-320" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.6 Autres Métriques</span></span>
<span id="cb19-321"><a href="#cb19-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-322"><a href="#cb19-322" aria-hidden="true" tabindex="-1"></a>**Specificity (Spécificité)**:</span>
<span id="cb19-323"><a href="#cb19-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-324"><a href="#cb19-324" aria-hidden="true" tabindex="-1"></a>$$\text{Specificity} = \frac{TN}{TN + FP}$$</span>
<span id="cb19-325"><a href="#cb19-325" aria-hidden="true" tabindex="-1"></a>Proportion de vrais négatifs correctement identifiés</span>
<span id="cb19-326"><a href="#cb19-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-327"><a href="#cb19-327" aria-hidden="true" tabindex="-1"></a>**F-Beta Score**:</span>
<span id="cb19-328"><a href="#cb19-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-329"><a href="#cb19-329" aria-hidden="true" tabindex="-1"></a>$$F_\beta = (1 + \beta^2) \times \frac{\text{Precision} \times \text{Recall}}{\beta^2 \times \text{Precision} + \text{Recall}}$$</span>
<span id="cb19-330"><a href="#cb19-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-331"><a href="#cb19-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta &gt; 1$: Favorise le Recall</span>
<span id="cb19-332"><a href="#cb19-332" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta &lt; 1$: Favorise la Precision</span>
<span id="cb19-333"><a href="#cb19-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-334"><a href="#cb19-334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercice 2.1: Calcul de Métriques</span></span>
<span id="cb19-335"><a href="#cb19-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-336"><a href="#cb19-336" aria-hidden="true" tabindex="-1"></a>Soit la matrice de confusion suivante pour un détecteur de tumeurs malignes:</span>
<span id="cb19-337"><a href="#cb19-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-338"><a href="#cb19-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-339"><a href="#cb19-339" aria-hidden="true" tabindex="-1"></a><span class="in">              Prédiction</span></span>
<span id="cb19-340"><a href="#cb19-340" aria-hidden="true" tabindex="-1"></a><span class="in">           Bénigne  Maligne</span></span>
<span id="cb19-341"><a href="#cb19-341" aria-hidden="true" tabindex="-1"></a><span class="in">Réalité Bénigne    850      50</span></span>
<span id="cb19-342"><a href="#cb19-342" aria-hidden="true" tabindex="-1"></a><span class="in">       Maligne     20       80</span></span>
<span id="cb19-343"><a href="#cb19-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-345"><a href="#cb19-345" aria-hidden="true" tabindex="-1"></a>**Questions:**</span>
<span id="cb19-346"><a href="#cb19-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-347"><a href="#cb19-347" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculez Accuracy, Precision, Recall, F1-Score</span>
<span id="cb19-348"><a href="#cb19-348" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Quelle métrique est la plus importante dans ce contexte? Pourquoi?</span>
<span id="cb19-349"><a href="#cb19-349" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Le modèle est-il satisfaisant? Justifiez.</span>
<span id="cb19-350"><a href="#cb19-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-351"><a href="#cb19-351" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb19-352"><a href="#cb19-352" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Exercice 2.1</span></span>
<span id="cb19-353"><a href="#cb19-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-356"><a href="#cb19-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-358"><a href="#cb19-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-359"><a href="#cb19-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-360"><a href="#cb19-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-361"><a href="#cb19-361" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-362"><a href="#cb19-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-363"><a href="#cb19-363" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb19-364"><a href="#cb19-364" aria-hidden="true" tabindex="-1"></a><span class="co">#          Bénigne  Maligne</span></span>
<span id="cb19-365"><a href="#cb19-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Bénigne    850      50</span></span>
<span id="cb19-366"><a href="#cb19-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Maligne     20      80</span></span>
<span id="cb19-367"><a href="#cb19-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-368"><a href="#cb19-368" aria-hidden="true" tabindex="-1"></a>tn <span class="op">=</span> <span class="dv">850</span>  <span class="co"># Bénigne correctement identifié</span></span>
<span id="cb19-369"><a href="#cb19-369" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> <span class="dv">50</span>   <span class="co"># Bénigne prédit Maligne</span></span>
<span id="cb19-370"><a href="#cb19-370" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="dv">20</span>   <span class="co"># Maligne prédit Bénigne</span></span>
<span id="cb19-371"><a href="#cb19-371" aria-hidden="true" tabindex="-1"></a>tp <span class="op">=</span> <span class="dv">80</span>   <span class="co"># Maligne correctement identifié</span></span>
<span id="cb19-372"><a href="#cb19-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-373"><a href="#cb19-373" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> tn <span class="op">+</span> fp <span class="op">+</span> fn <span class="op">+</span> tp</span>
<span id="cb19-374"><a href="#cb19-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-375"><a href="#cb19-375" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Calcul des métriques</span></span>
<span id="cb19-376"><a href="#cb19-376" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> total</span>
<span id="cb19-377"><a href="#cb19-377" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span>
<span id="cb19-378"><a href="#cb19-378" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb19-379"><a href="#cb19-379" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (precision <span class="op">*</span> recall) <span class="op">/</span> (precision <span class="op">+</span> recall)</span>
<span id="cb19-380"><a href="#cb19-380" aria-hidden="true" tabindex="-1"></a>specificity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb19-381"><a href="#cb19-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-382"><a href="#cb19-382" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. Métriques calculées:"</span>)</span>
<span id="cb19-383"><a href="#cb19-383" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy:    </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>accuracy<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-384"><a href="#cb19-384" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precision:   </span><span class="sc">{</span>precision<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>precision<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-385"><a href="#cb19-385" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Recall:      </span><span class="sc">{</span>recall<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>recall<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-386"><a href="#cb19-386" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F1-Score:    </span><span class="sc">{</span>f1<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>f1<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-387"><a href="#cb19-387" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Specificity: </span><span class="sc">{</span>specificity<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>specificity<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-388"><a href="#cb19-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-389"><a href="#cb19-389" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Métrique la plus importante</span></span>
<span id="cb19-390"><a href="#cb19-390" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Métrique la plus importante: RECALL"</span>)</span>
<span id="cb19-391"><a href="#cb19-391" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Raison: En médical, ne pas détecter un cancer (FN) est"</span>)</span>
<span id="cb19-392"><a href="#cb19-392" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   beaucoup plus grave qu'une fausse alarme (FP)."</span>)</span>
<span id="cb19-393"><a href="#cb19-393" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Actuellement, Recall = </span><span class="sc">{</span>recall<span class="sc">:.2%}</span><span class="ss"> signifie que"</span>)</span>
<span id="cb19-394"><a href="#cb19-394" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> cancers sur </span><span class="sc">{</span>tp<span class="op">+</span>fn<span class="sc">}</span><span class="ss"> ne sont pas détectés!"</span>)</span>
<span id="cb19-395"><a href="#cb19-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-396"><a href="#cb19-396" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Évaluation</span></span>
<span id="cb19-397"><a href="#cb19-397" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Évaluation du modèle:"</span>)</span>
<span id="cb19-398"><a href="#cb19-398" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   X Recall de </span><span class="sc">{</span>recall<span class="sc">:.2%}</span><span class="ss"> est INSUFFISANT"</span>)</span>
<span id="cb19-399"><a href="#cb19-399" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   X 20% de cancers manqués = inacceptable"</span>)</span>
<span id="cb19-400"><a href="#cb19-400" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   $</span><span class="er">\</span><span class="ss">checkmark$ Precision de </span><span class="sc">{</span>precision<span class="sc">:.2%}</span><span class="ss"> est correcte"</span>)</span>
<span id="cb19-401"><a href="#cb19-401" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   $</span><span class="er">\</span><span class="ss">checkmark$ Specificity de </span><span class="sc">{</span>specificity<span class="sc">:.2%}</span><span class="ss"> est bonne"</span>)</span>
<span id="cb19-402"><a href="#cb19-402" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   CONCLUSION: Modèle à améliorer!"</span>)</span>
<span id="cb19-403"><a href="#cb19-403" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Recommandation: Abaisser le seuil de décision pour"</span>)</span>
<span id="cb19-404"><a href="#cb19-404" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   augmenter le Recall, même au prix de la Precision."</span>)</span>
<span id="cb19-405"><a href="#cb19-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-406"><a href="#cb19-406" aria-hidden="true" tabindex="-1"></a><span class="co"># Impact en nombre de patients</span></span>
<span id="cb19-407"><a href="#cb19-407" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Impact sur 1000 patients:"</span>)</span>
<span id="cb19-408"><a href="#cb19-408" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - 20 cancers NON DÉTECTÉS (FN) ← CRITIQUE"</span>)</span>
<span id="cb19-409"><a href="#cb19-409" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - 50 fausses alarmes (FP) ← Acceptable (examens complémentaires)"</span>)</span>
<span id="cb19-410"><a href="#cb19-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-411"><a href="#cb19-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-412"><a href="#cb19-412" aria-hidden="true" tabindex="-1"></a>**Réponses:**</span>
<span id="cb19-413"><a href="#cb19-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-414"><a href="#cb19-414" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Métriques:**</span>
<span id="cb19-415"><a href="#cb19-415" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Accuracy: 93.00%</span>
<span id="cb19-416"><a href="#cb19-416" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Precision: 61.54%</span>
<span id="cb19-417"><a href="#cb19-417" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Recall: 80.00%</span>
<span id="cb19-418"><a href="#cb19-418" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>F1-Score: 69.57%</span>
<span id="cb19-419"><a href="#cb19-419" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Specificity: 94.44%</span>
<span id="cb19-420"><a href="#cb19-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-421"><a href="#cb19-421" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Métrique importante: RECALL**</span>
<span id="cb19-422"><a href="#cb19-422" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Un cancer non détecté (FN) peut être mortel</span>
<span id="cb19-423"><a href="#cb19-423" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Une fausse alarme (FP) → examens supplémentaires (acceptable)</span>
<span id="cb19-424"><a href="#cb19-424" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Donc: mieux vaut trop détecter que pas assez</span>
<span id="cb19-425"><a href="#cb19-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-426"><a href="#cb19-426" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Évaluation:**</span>
<span id="cb19-427"><a href="#cb19-427" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>X Recall de 80% **insuffisant** (20% de cancers manqués)</span>
<span id="cb19-428"><a href="#cb19-428" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>$\checkmark$ Specificity correcte</span>
<span id="cb19-429"><a href="#cb19-429" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Conclusion**: Modèle dangereux en l'état</span>
<span id="cb19-430"><a href="#cb19-430" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Action**: Réduire le seuil pour augmenter Recall</span>
<span id="cb19-431"><a href="#cb19-431" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-432"><a href="#cb19-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-433"><a href="#cb19-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Courbe ROC et AUC</span></span>
<span id="cb19-434"><a href="#cb19-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-435"><a href="#cb19-435" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 Courbe ROC (Receiver Operating Characteristic)</span></span>
<span id="cb19-436"><a href="#cb19-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-437"><a href="#cb19-437" aria-hidden="true" tabindex="-1"></a>La **courbe ROC** visualise les performances d'un classificateur binaire en variant le seuil de décision.</span>
<span id="cb19-438"><a href="#cb19-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-439"><a href="#cb19-439" aria-hidden="true" tabindex="-1"></a>**Axes:**</span>
<span id="cb19-440"><a href="#cb19-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-441"><a href="#cb19-441" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**X**: False Positive Rate (FPR) = $\frac{FP}{FP + TN}$ = 1 - Specificity</span>
<span id="cb19-442"><a href="#cb19-442" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Y**: True Positive Rate (TPR) = $\frac{TP}{TP + FN}$ = Recall</span>
<span id="cb19-443"><a href="#cb19-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-446"><a href="#cb19-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-447"><a href="#cb19-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-448"><a href="#cb19-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-449"><a href="#cb19-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-450"><a href="#cb19-450" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, roc_auc_score</span>
<span id="cb19-451"><a href="#cb19-451" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-452"><a href="#cb19-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-453"><a href="#cb19-453" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir les probabilités (pas les classes)</span></span>
<span id="cb19-454"><a href="#cb19-454" aria-hidden="true" tabindex="-1"></a>y_proba <span class="op">=</span> model.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb19-455"><a href="#cb19-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-456"><a href="#cb19-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les points de la courbe ROC</span></span>
<span id="cb19-457"><a href="#cb19-457" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresholds <span class="op">=</span> roc_curve(y_test, y_proba)</span>
<span id="cb19-458"><a href="#cb19-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-459"><a href="#cb19-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracer la courbe</span></span>
<span id="cb19-460"><a href="#cb19-460" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb19-461"><a href="#cb19-461" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'ROC Curve'</span>)</span>
<span id="cb19-462"><a href="#cb19-462" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>, label<span class="op">=</span><span class="st">'Random (AUC=0.5)'</span>)</span>
<span id="cb19-463"><a href="#cb19-463" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False Positive Rate (1 - Specificity)'</span>)</span>
<span id="cb19-464"><a href="#cb19-464" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Positive Rate (Recall)'</span>)</span>
<span id="cb19-465"><a href="#cb19-465" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Courbe ROC'</span>)</span>
<span id="cb19-466"><a href="#cb19-466" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb19-467"><a href="#cb19-467" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-468"><a href="#cb19-468" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-469"><a href="#cb19-469" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-470"><a href="#cb19-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-471"><a href="#cb19-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-472"><a href="#cb19-472" aria-hidden="true" tabindex="-1"></a>**Interprétation des points:**</span>
<span id="cb19-473"><a href="#cb19-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-474"><a href="#cb19-474" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Point (0, 0)**: Tout prédit négatif (seuil = 1.0)</span>
<span id="cb19-475"><a href="#cb19-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Point (1, 1)**: Tout prédit positif (seuil = 0.0)</span>
<span id="cb19-476"><a href="#cb19-476" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Point (0, 1)**: Classificateur parfait</span>
<span id="cb19-477"><a href="#cb19-477" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Diagonale**: Classificateur aléatoire</span>
<span id="cb19-478"><a href="#cb19-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-479"><a href="#cb19-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 AUC (Area Under Curve)</span></span>
<span id="cb19-480"><a href="#cb19-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-481"><a href="#cb19-481" aria-hidden="true" tabindex="-1"></a>L'**AUC** est l'aire sous la courbe ROC.</span>
<span id="cb19-482"><a href="#cb19-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-483"><a href="#cb19-483" aria-hidden="true" tabindex="-1"></a>**Interprétation:**</span>
<span id="cb19-484"><a href="#cb19-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-485"><a href="#cb19-485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC = 1.0**: Classificateur parfait</span>
<span id="cb19-486"><a href="#cb19-486" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC = 0.9 - 1.0**: Excellent</span>
<span id="cb19-487"><a href="#cb19-487" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC = 0.8 - 0.9**: Très bon</span>
<span id="cb19-488"><a href="#cb19-488" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC = 0.7 - 0.8**: Bon</span>
<span id="cb19-489"><a href="#cb19-489" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC = 0.6 - 0.7**: Médiocre</span>
<span id="cb19-490"><a href="#cb19-490" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC = 0.5**: Aléatoire (inutile)</span>
<span id="cb19-491"><a href="#cb19-491" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AUC &lt; 0.5**: Pire qu'aléatoire (inverser les prédictions!)</span>
<span id="cb19-492"><a href="#cb19-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-495"><a href="#cb19-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-496"><a href="#cb19-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-497"><a href="#cb19-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-498"><a href="#cb19-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-499"><a href="#cb19-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l'AUC</span></span>
<span id="cb19-500"><a href="#cb19-500" aria-hidden="true" tabindex="-1"></a>auc <span class="op">=</span> roc_auc_score(y_test, y_proba)</span>
<span id="cb19-501"><a href="#cb19-501" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"AUC Score: </span><span class="sc">{</span>auc<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-502"><a href="#cb19-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-503"><a href="#cb19-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-504"><a href="#cb19-504" aria-hidden="true" tabindex="-1"></a>**Avantages de l'AUC:**</span>
<span id="cb19-505"><a href="#cb19-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-506"><a href="#cb19-506" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Indépendant du seuil de décision</span>
<span id="cb19-507"><a href="#cb19-507" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robuste aux classes déséquilibrées</span>
<span id="cb19-508"><a href="#cb19-508" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Facile à interpréter (une seule valeur)</span>
<span id="cb19-509"><a href="#cb19-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-510"><a href="#cb19-510" aria-hidden="true" tabindex="-1"></a>**Signification probabiliste:**</span>
<span id="cb19-511"><a href="#cb19-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-512"><a href="#cb19-512" aria-hidden="true" tabindex="-1"></a>AUC = probabilité qu'un exemple positif aléatoire ait un score plus élevé qu'un exemple négatif aléatoire</span>
<span id="cb19-513"><a href="#cb19-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-514"><a href="#cb19-514" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercice 3.1: Analyse de Courbe ROC</span></span>
<span id="cb19-515"><a href="#cb19-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-516"><a href="#cb19-516" aria-hidden="true" tabindex="-1"></a>Vous avez trois modèles avec les AUC suivants:</span>
<span id="cb19-517"><a href="#cb19-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-518"><a href="#cb19-518" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modèle A: AUC = 0.95</span>
<span id="cb19-519"><a href="#cb19-519" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modèle B: AUC = 0.75</span>
<span id="cb19-520"><a href="#cb19-520" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modèle C: AUC = 0.52</span>
<span id="cb19-521"><a href="#cb19-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-522"><a href="#cb19-522" aria-hidden="true" tabindex="-1"></a>**Questions:**</span>
<span id="cb19-523"><a href="#cb19-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-524"><a href="#cb19-524" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Classez les modèles par performance</span>
<span id="cb19-525"><a href="#cb19-525" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Quel modèle choisiriez-vous pour détecter des fraudes bancaires?</span>
<span id="cb19-526"><a href="#cb19-526" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Dans quel cas le Modèle C pourrait-il être utile?</span>
<span id="cb19-527"><a href="#cb19-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-528"><a href="#cb19-528" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb19-529"><a href="#cb19-529" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Exercice 3.1</span></span>
<span id="cb19-530"><a href="#cb19-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-533"><a href="#cb19-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-534"><a href="#cb19-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-535"><a href="#cb19-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-536"><a href="#cb19-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-537"><a href="#cb19-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-538"><a href="#cb19-538" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-539"><a href="#cb19-539" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-540"><a href="#cb19-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-541"><a href="#cb19-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation de courbes ROC</span></span>
<span id="cb19-542"><a href="#cb19-542" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb19-543"><a href="#cb19-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-544"><a href="#cb19-544" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle A (excellent)</span></span>
<span id="cb19-545"><a href="#cb19-545" aria-hidden="true" tabindex="-1"></a>fpr_a <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb19-546"><a href="#cb19-546" aria-hidden="true" tabindex="-1"></a>tpr_a <span class="op">=</span> np.power(fpr_a, <span class="fl">0.2</span>)  <span class="co"># Courbe très au-dessus de la diagonale</span></span>
<span id="cb19-547"><a href="#cb19-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-548"><a href="#cb19-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle B (bon)</span></span>
<span id="cb19-549"><a href="#cb19-549" aria-hidden="true" tabindex="-1"></a>fpr_b <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb19-550"><a href="#cb19-550" aria-hidden="true" tabindex="-1"></a>tpr_b <span class="op">=</span> np.power(fpr_b, <span class="fl">0.6</span>)</span>
<span id="cb19-551"><a href="#cb19-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-552"><a href="#cb19-552" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle C (quasi-aléatoire)</span></span>
<span id="cb19-553"><a href="#cb19-553" aria-hidden="true" tabindex="-1"></a>fpr_c <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb19-554"><a href="#cb19-554" aria-hidden="true" tabindex="-1"></a>tpr_c <span class="op">=</span> fpr_c <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="dv">100</span>)</span>
<span id="cb19-555"><a href="#cb19-555" aria-hidden="true" tabindex="-1"></a>tpr_c <span class="op">=</span> np.clip(tpr_c, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-556"><a href="#cb19-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-557"><a href="#cb19-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb19-558"><a href="#cb19-558" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb19-559"><a href="#cb19-559" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_a, tpr_a, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Modèle A (AUC=0.95)'</span>)</span>
<span id="cb19-560"><a href="#cb19-560" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_b, tpr_b, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Modèle B (AUC=0.75)'</span>)</span>
<span id="cb19-561"><a href="#cb19-561" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_c, tpr_c, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Modèle C (AUC=0.52)'</span>)</span>
<span id="cb19-562"><a href="#cb19-562" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'Aléatoire (AUC=0.5)'</span>)</span>
<span id="cb19-563"><a href="#cb19-563" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False Positive Rate'</span>)</span>
<span id="cb19-564"><a href="#cb19-564" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Positive Rate'</span>)</span>
<span id="cb19-565"><a href="#cb19-565" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparaison des Courbes ROC'</span>)</span>
<span id="cb19-566"><a href="#cb19-566" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb19-567"><a href="#cb19-567" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-568"><a href="#cb19-568" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-569"><a href="#cb19-569" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-570"><a href="#cb19-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-571"><a href="#cb19-571" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. Classement par performance:"</span>)</span>
<span id="cb19-572"><a href="#cb19-572" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1er: Modèle A (AUC=0.95) - Excellent"</span>)</span>
<span id="cb19-573"><a href="#cb19-573" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2e:  Modèle B (AUC=0.75) - Bon"</span>)</span>
<span id="cb19-574"><a href="#cb19-574" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3e:  Modèle C (AUC=0.52) - Quasi-aléatoire"</span>)</span>
<span id="cb19-575"><a href="#cb19-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-576"><a href="#cb19-576" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Pour détecter des fraudes:"</span>)</span>
<span id="cb19-577"><a href="#cb19-577" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   → Modèle A (AUC=0.95)"</span>)</span>
<span id="cb19-578"><a href="#cb19-578" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Raison: Meilleure capacité à distinguer fraude/légitime"</span>)</span>
<span id="cb19-579"><a href="#cb19-579" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Permet d'ajuster le seuil selon coût FP vs FN"</span>)</span>
<span id="cb19-580"><a href="#cb19-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-581"><a href="#cb19-581" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Utilité du Modèle C:"</span>)</span>
<span id="cb19-582"><a href="#cb19-582" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   → Quasiment aucune!"</span>)</span>
<span id="cb19-583"><a href="#cb19-583" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   AUC=0.52 $</span><span class="ch">\a</span><span class="st">pprox$ tirage à pile ou face"</span>)</span>
<span id="cb19-584"><a href="#cb19-584" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   SAUF: Si on inverse ses prédictions → AUC=0.48"</span>)</span>
<span id="cb19-585"><a href="#cb19-585" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   → Peut indiquer un bug dans le code/labels"</span>)</span>
<span id="cb19-586"><a href="#cb19-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-587"><a href="#cb19-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-588"><a href="#cb19-588" aria-hidden="true" tabindex="-1"></a>**Réponses:**</span>
<span id="cb19-589"><a href="#cb19-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-590"><a href="#cb19-590" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Classement**: A &gt; B &gt; C</span>
<span id="cb19-591"><a href="#cb19-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-592"><a href="#cb19-592" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>A est excellent</span>
<span id="cb19-593"><a href="#cb19-593" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>B est bon mais moins performant</span>
<span id="cb19-594"><a href="#cb19-594" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>C est pratiquement inutile</span>
<span id="cb19-595"><a href="#cb19-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-596"><a href="#cb19-596" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Fraude bancaire: Modèle A**</span>
<span id="cb19-597"><a href="#cb19-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-598"><a href="#cb19-598" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>AUC élevé = meilleure discrimination</span>
<span id="cb19-599"><a href="#cb19-599" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Important car coûts élevés (fraudes manquées + fausses alarmes)</span>
<span id="cb19-600"><a href="#cb19-600" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Permet de choisir le seuil optimal selon les coûts métier</span>
<span id="cb19-601"><a href="#cb19-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-602"><a href="#cb19-602" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Utilité de C:**</span>
<span id="cb19-603"><a href="#cb19-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-604"><a href="#cb19-604" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Pratiquement aucune (performance aléatoire)</span>
<span id="cb19-605"><a href="#cb19-605" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Pourrait indiquer un problème (bug, labels inversés, features non pertinentes)</span>
<span id="cb19-606"><a href="#cb19-606" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Si AUC &lt; 0.5: inverser les prédictions pourrait aider!</span>
<span id="cb19-607"><a href="#cb19-607" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-608"><a href="#cb19-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-609"><a href="#cb19-609" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Choix de Métriques selon le Contexte</span></span>
<span id="cb19-610"><a href="#cb19-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-611"><a href="#cb19-611" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1 Tableau de Décision</span></span>
<span id="cb19-612"><a href="#cb19-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-613"><a href="#cb19-613" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Contexte <span class="pp">|</span> Métrique Principale <span class="pp">|</span> Raison <span class="pp">|</span></span>
<span id="cb19-614"><a href="#cb19-614" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-------------------|---------|</span></span>
<span id="cb19-615"><a href="#cb19-615" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Détection de spam** <span class="pp">|</span> Precision <span class="pp">|</span> Éviter de perdre emails importants (FP coûteux) <span class="pp">|</span></span>
<span id="cb19-616"><a href="#cb19-616" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Détection de cancer** <span class="pp">|</span> Recall <span class="pp">|</span> Ne manquer aucun malade (FN critique) <span class="pp">|</span></span>
<span id="cb19-617"><a href="#cb19-617" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Moteur de recherche** <span class="pp">|</span> Precision@K <span class="pp">|</span> Premiers résultats doivent être pertinents <span class="pp">|</span></span>
<span id="cb19-618"><a href="#cb19-618" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Fraude bancaire** <span class="pp">|</span> F1 ou AUC <span class="pp">|</span> Équilibre entre détecter fraudes et éviter fausses alarmes <span class="pp">|</span></span>
<span id="cb19-619"><a href="#cb19-619" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Système de recommandation** <span class="pp">|</span> Precision <span class="pp">|</span> Recommandations doivent être pertinentes <span class="pp">|</span></span>
<span id="cb19-620"><a href="#cb19-620" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Détection d'intrusion réseau** <span class="pp">|</span> Recall <span class="pp">|</span> Ne rater aucune attaque (FN dangereux) <span class="pp">|</span></span>
<span id="cb19-621"><a href="#cb19-621" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Diagnostic automatisé** <span class="pp">|</span> Recall + Precision <span class="pp">|</span> Les deux sont importants (vies humaines) <span class="pp">|</span></span>
<span id="cb19-622"><a href="#cb19-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-623"><a href="#cb19-623" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2 Classes Déséquilibrées</span></span>
<span id="cb19-624"><a href="#cb19-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-625"><a href="#cb19-625" aria-hidden="true" tabindex="-1"></a>Lorsque les classes sont **très déséquilibrées** (ex: 1% positifs, 99% négatifs):</span>
<span id="cb19-626"><a href="#cb19-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-627"><a href="#cb19-627" aria-hidden="true" tabindex="-1"></a>**❌ À ÉVITER:**</span>
<span id="cb19-628"><a href="#cb19-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-629"><a href="#cb19-629" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy (trompeuse)</span>
<span id="cb19-630"><a href="#cb19-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-631"><a href="#cb19-631" aria-hidden="true" tabindex="-1"></a>**✅ À UTILISER:**</span>
<span id="cb19-632"><a href="#cb19-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-633"><a href="#cb19-633" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Precision, Recall, F1-Score</span>
<span id="cb19-634"><a href="#cb19-634" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AUC-ROC</span>
<span id="cb19-635"><a href="#cb19-635" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Precision-Recall curve</span>
<span id="cb19-636"><a href="#cb19-636" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Balanced Accuracy = $\frac{\text{Recall} + \text{Specificity}}{2}$</span>
<span id="cb19-637"><a href="#cb19-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-640"><a href="#cb19-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-641"><a href="#cb19-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-642"><a href="#cb19-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-643"><a href="#cb19-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-644"><a href="#cb19-644" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> balanced_accuracy_score</span>
<span id="cb19-645"><a href="#cb19-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-646"><a href="#cb19-646" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy normale (biaisée si déséquilibre)</span></span>
<span id="cb19-647"><a href="#cb19-647" aria-hidden="true" tabindex="-1"></a>acc <span class="op">=</span> accuracy_score(y_true, y_pred)</span>
<span id="cb19-648"><a href="#cb19-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-649"><a href="#cb19-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Balanced accuracy (moyenne de recall et specificity)</span></span>
<span id="cb19-650"><a href="#cb19-650" aria-hidden="true" tabindex="-1"></a>balanced_acc <span class="op">=</span> balanced_accuracy_score(y_true, y_pred)</span>
<span id="cb19-651"><a href="#cb19-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-652"><a href="#cb19-652" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>acc<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-653"><a href="#cb19-653" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Balanced Accuracy: </span><span class="sc">{</span>balanced_acc<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-654"><a href="#cb19-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-655"><a href="#cb19-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-656"><a href="#cb19-656" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercice 4.1: Choix de Métrique</span></span>
<span id="cb19-657"><a href="#cb19-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-658"><a href="#cb19-658" aria-hidden="true" tabindex="-1"></a>Pour chaque scénario, choisissez la métrique la plus appropriée et justifiez:</span>
<span id="cb19-659"><a href="#cb19-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-660"><a href="#cb19-660" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Système de reconnaissance faciale pour déverrouillage de téléphone**</span>
<span id="cb19-661"><a href="#cb19-661" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Filtre anti-spam Gmail**</span>
<span id="cb19-662"><a href="#cb19-662" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Détection de COVID-19 par test rapide**</span>
<span id="cb19-663"><a href="#cb19-663" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Système de recommandation Netflix**</span>
<span id="cb19-664"><a href="#cb19-664" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Détection de transactions frauduleuses (0.1% de fraudes)**</span>
<span id="cb19-665"><a href="#cb19-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-666"><a href="#cb19-666" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb19-667"><a href="#cb19-667" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Exercice 4.1</span></span>
<span id="cb19-668"><a href="#cb19-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-669"><a href="#cb19-669" aria-hidden="true" tabindex="-1"></a>**1. Reconnaissance faciale pour téléphone:**</span>
<span id="cb19-670"><a href="#cb19-670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Métrique**: **Precision** (prioritaire) + FPR faible</span>
<span id="cb19-671"><a href="#cb19-671" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Justification**:</span>
<span id="cb19-672"><a href="#cb19-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-673"><a href="#cb19-673" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FP = Personne non autorisée accède au téléphone (GRAVE - sécurité)</span>
<span id="cb19-674"><a href="#cb19-674" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FN = Propriétaire doit retenter (MINEUR - inconvénient)</span>
<span id="cb19-675"><a href="#cb19-675" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Mieux vaut bloquer le propriétaire parfois que laisser entrer un intrus</span>
<span id="cb19-676"><a href="#cb19-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-677"><a href="#cb19-677" aria-hidden="true" tabindex="-1"></a>**2. Filtre anti-spam Gmail:**</span>
<span id="cb19-678"><a href="#cb19-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-679"><a href="#cb19-679" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Métrique**: **Precision** (prioritaire)</span>
<span id="cb19-680"><a href="#cb19-680" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Justification**:</span>
<span id="cb19-681"><a href="#cb19-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-682"><a href="#cb19-682" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FP = Email important dans spam (GRAVE - peut manquer info critique)</span>
<span id="cb19-683"><a href="#cb19-683" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FN = Spam en boîte de réception (MINEUR - simple nuisance)</span>
<span id="cb19-684"><a href="#cb19-684" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Gmail préfère laisser passer du spam que bloquer des emails légitimes</span>
<span id="cb19-685"><a href="#cb19-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-686"><a href="#cb19-686" aria-hidden="true" tabindex="-1"></a>**3. Détection COVID-19:**</span>
<span id="cb19-687"><a href="#cb19-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-688"><a href="#cb19-688" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Métrique**: **Recall** (prioritaire)</span>
<span id="cb19-689"><a href="#cb19-689" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Justification**:</span>
<span id="cb19-690"><a href="#cb19-690" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FN = Malade non détecté → propage le virus (GRAVE - santé publique)</span>
<span id="cb19-691"><a href="#cb19-691" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FP = Personne saine isolée inutilement (MINEUR - test confirmatoire possible)</span>
<span id="cb19-692"><a href="#cb19-692" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Mieux vaut trop détecter que pas assez</span>
<span id="cb19-693"><a href="#cb19-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-694"><a href="#cb19-694" aria-hidden="true" tabindex="-1"></a>**4. Recommandation Netflix:**</span>
<span id="cb19-695"><a href="#cb19-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-696"><a href="#cb19-696" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Métrique**: **Precision@K** (K = nombre de recommandations affichées)</span>
<span id="cb19-697"><a href="#cb19-697" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Justification**:</span>
<span id="cb19-698"><a href="#cb19-698" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Utilisateur voit seulement les K premières recommandations</span>
<span id="cb19-699"><a href="#cb19-699" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Celles-ci doivent être pertinentes pour satisfaction client</span>
<span id="cb19-700"><a href="#cb19-700" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Recall moins important (on ne peut pas tout recommander)</span>
<span id="cb19-701"><a href="#cb19-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-702"><a href="#cb19-702" aria-hidden="true" tabindex="-1"></a>**5. Fraude bancaire (0.1% de fraudes):**</span>
<span id="cb19-703"><a href="#cb19-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-704"><a href="#cb19-704" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Métriques**: **F1-Score** + **AUC-ROC** + **Precision-Recall curve**</span>
<span id="cb19-705"><a href="#cb19-705" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Justification**:</span>
<span id="cb19-706"><a href="#cb19-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-707"><a href="#cb19-707" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Classes très déséquilibrées → Accuracy inutile</span>
<span id="cb19-708"><a href="#cb19-708" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FP = Client bloqué à tort (coûteux - insatisfaction)</span>
<span id="cb19-709"><a href="#cb19-709" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>FN = Fraude non détectée (très coûteux - pertes financières)</span>
<span id="cb19-710"><a href="#cb19-710" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Besoin d'équilibre → F1 ou optimiser selon coûts métier</span>
<span id="cb19-711"><a href="#cb19-711" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>AUC pour comparer modèles indépendamment du seuil</span>
<span id="cb19-712"><a href="#cb19-712" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-713"><a href="#cb19-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-714"><a href="#cb19-714" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Exercice Récapitulatif Complet</span></span>
<span id="cb19-715"><a href="#cb19-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-716"><a href="#cb19-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scénario: Détecteur de Défauts en Usine</span></span>
<span id="cb19-717"><a href="#cb19-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-718"><a href="#cb19-718" aria-hidden="true" tabindex="-1"></a>Une usine produit 10,000 pièces par jour. En moyenne, 100 pièces (1%) sont défectueuses.</span>
<span id="cb19-719"><a href="#cb19-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-720"><a href="#cb19-720" aria-hidden="true" tabindex="-1"></a>Vous avez développé un modèle de détection automatique qui donne les résultats suivants sur 1000 pièces de test:</span>
<span id="cb19-721"><a href="#cb19-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-722"><a href="#cb19-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-723"><a href="#cb19-723" aria-hidden="true" tabindex="-1"></a><span class="in">              Prédiction</span></span>
<span id="cb19-724"><a href="#cb19-724" aria-hidden="true" tabindex="-1"></a><span class="in">           OK    Défectueux</span></span>
<span id="cb19-725"><a href="#cb19-725" aria-hidden="true" tabindex="-1"></a><span class="in">Réalité OK    970      20</span></span>
<span id="cb19-726"><a href="#cb19-726" aria-hidden="true" tabindex="-1"></a><span class="in">     Défect.   3       7</span></span>
<span id="cb19-727"><a href="#cb19-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-728"><a href="#cb19-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-729"><a href="#cb19-729" aria-hidden="true" tabindex="-1"></a>**Coûts:**</span>
<span id="cb19-730"><a href="#cb19-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-731"><a href="#cb19-731" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pièce défectueuse non détectée (FN): **500€** (vendue puis retournée par client)</span>
<span id="cb19-732"><a href="#cb19-732" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pièce OK rejetée à tort (FP): **10€** (inspection manuelle inutile)</span>
<span id="cb19-733"><a href="#cb19-733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Inspection manuelle d'une pièce: **5€**</span>
<span id="cb19-734"><a href="#cb19-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-735"><a href="#cb19-735" aria-hidden="true" tabindex="-1"></a>**Questions:**</span>
<span id="cb19-736"><a href="#cb19-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-737"><a href="#cb19-737" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculez toutes les métriques (Accuracy, Precision, Recall, F1, Specificity)</span>
<span id="cb19-738"><a href="#cb19-738" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Le modèle est-il acceptable d'un point de vue métier?</span>
<span id="cb19-739"><a href="#cb19-739" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Calculez le coût total journalier des erreurs</span>
<span id="cb19-740"><a href="#cb19-740" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Quelle métrique devriez-vous optimiser en priorité?</span>
<span id="cb19-741"><a href="#cb19-741" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Proposez une amélioration du modèle</span>
<span id="cb19-742"><a href="#cb19-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-743"><a href="#cb19-743" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb19-744"><a href="#cb19-744" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Exercice Récapitulatif</span></span>
<span id="cb19-745"><a href="#cb19-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-748"><a href="#cb19-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-749"><a href="#cb19-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-750"><a href="#cb19-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-751"><a href="#cb19-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-752"><a href="#cb19-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-753"><a href="#cb19-753" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-754"><a href="#cb19-754" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb19-755"><a href="#cb19-755" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-756"><a href="#cb19-756" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb19-757"><a href="#cb19-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-758"><a href="#cb19-758" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb19-759"><a href="#cb19-759" aria-hidden="true" tabindex="-1"></a><span class="co">#           OK    Défect</span></span>
<span id="cb19-760"><a href="#cb19-760" aria-hidden="true" tabindex="-1"></a><span class="co"># OK       970      20</span></span>
<span id="cb19-761"><a href="#cb19-761" aria-hidden="true" tabindex="-1"></a><span class="co"># Défect     3       7</span></span>
<span id="cb19-762"><a href="#cb19-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-763"><a href="#cb19-763" aria-hidden="true" tabindex="-1"></a>tn, fp <span class="op">=</span> <span class="dv">970</span>, <span class="dv">20</span></span>
<span id="cb19-764"><a href="#cb19-764" aria-hidden="true" tabindex="-1"></a>fn, tp <span class="op">=</span> <span class="dv">3</span>, <span class="dv">7</span></span>
<span id="cb19-765"><a href="#cb19-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-766"><a href="#cb19-766" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> tn <span class="op">+</span> fp <span class="op">+</span> fn <span class="op">+</span> tp</span>
<span id="cb19-767"><a href="#cb19-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-768"><a href="#cb19-768" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-769"><a href="#cb19-769" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANALYSE DU DÉTECTEUR DE DÉFAUTS"</span>)</span>
<span id="cb19-770"><a href="#cb19-770" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-771"><a href="#cb19-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-772"><a href="#cb19-772" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Métriques</span></span>
<span id="cb19-773"><a href="#cb19-773" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. MÉTRIQUES DE PERFORMANCE:"</span>)</span>
<span id="cb19-774"><a href="#cb19-774" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-775"><a href="#cb19-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-776"><a href="#cb19-776" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> total</span>
<span id="cb19-777"><a href="#cb19-777" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span>
<span id="cb19-778"><a href="#cb19-778" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb19-779"><a href="#cb19-779" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (precision <span class="op">*</span> recall) <span class="op">/</span> (precision <span class="op">+</span> recall)</span>
<span id="cb19-780"><a href="#cb19-780" aria-hidden="true" tabindex="-1"></a>specificity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb19-781"><a href="#cb19-781" aria-hidden="true" tabindex="-1"></a>fpr <span class="op">=</span> fp <span class="op">/</span> (fp <span class="op">+</span> tn)</span>
<span id="cb19-782"><a href="#cb19-782" aria-hidden="true" tabindex="-1"></a>fnr <span class="op">=</span> fn <span class="op">/</span> (fn <span class="op">+</span> tp)</span>
<span id="cb19-783"><a href="#cb19-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-784"><a href="#cb19-784" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> {</span>
<span id="cb19-785"><a href="#cb19-785" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>: accuracy,</span>
<span id="cb19-786"><a href="#cb19-786" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>: precision,</span>
<span id="cb19-787"><a href="#cb19-787" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>: recall,</span>
<span id="cb19-788"><a href="#cb19-788" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1-Score'</span>: f1,</span>
<span id="cb19-789"><a href="#cb19-789" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Specificity'</span>: specificity,</span>
<span id="cb19-790"><a href="#cb19-790" aria-hidden="true" tabindex="-1"></a>    <span class="st">'False Positive Rate'</span>: fpr,</span>
<span id="cb19-791"><a href="#cb19-791" aria-hidden="true" tabindex="-1"></a>    <span class="st">'False Negative Rate'</span>: fnr</span>
<span id="cb19-792"><a href="#cb19-792" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-793"><a href="#cb19-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-794"><a href="#cb19-794" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> metrics.items():</span>
<span id="cb19-795"><a href="#cb19-795" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>metric<span class="sc">:25s}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>value<span class="op">*</span><span class="dv">100</span><span class="sc">:6.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-796"><a href="#cb19-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-797"><a href="#cb19-797" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Acceptabilité métier</span></span>
<span id="cb19-798"><a href="#cb19-798" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. ACCEPTABILITÉ MÉTIER:"</span>)</span>
<span id="cb19-799"><a href="#cb19-799" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-800"><a href="#cb19-800" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"X Recall = </span><span class="sc">{</span>recall<span class="sc">:.2%}</span><span class="ss"> est TRÈS FAIBLE"</span>)</span>
<span id="cb19-801"><a href="#cb19-801" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Sur 10 défauts, seulement </span><span class="sc">{</span>tp<span class="sc">}</span><span class="ss"> détectés, </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> manqués!"</span>)</span>
<span id="cb19-802"><a href="#cb19-802" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → </span><span class="sc">{</span>fnr<span class="sc">:.2%}</span><span class="ss"> de défauts passent inaperçus"</span>)</span>
<span id="cb19-803"><a href="#cb19-803" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">$</span><span class="er">\</span><span class="ss">checkmark$ Precision = </span><span class="sc">{</span>precision<span class="sc">:.2%}</span><span class="ss"> est acceptable"</span>)</span>
<span id="cb19-804"><a href="#cb19-804" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Peu de fausses alarmes"</span>)</span>
<span id="cb19-805"><a href="#cb19-805" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">X CONCLUSION: Modèle INACCEPTABLE"</span>)</span>
<span id="cb19-806"><a href="#cb19-806" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Trop de défauts non détectés atteignent les clients"</span>)</span>
<span id="cb19-807"><a href="#cb19-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-808"><a href="#cb19-808" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Coût journalier</span></span>
<span id="cb19-809"><a href="#cb19-809" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. COÛT TOTAL JOURNALIER:"</span>)</span>
<span id="cb19-810"><a href="#cb19-810" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-811"><a href="#cb19-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-812"><a href="#cb19-812" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrapolation à 10,000 pièces</span></span>
<span id="cb19-813"><a href="#cb19-813" aria-hidden="true" tabindex="-1"></a>total_pieces <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb19-814"><a href="#cb19-814" aria-hidden="true" tabindex="-1"></a>defect_rate <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb19-815"><a href="#cb19-815" aria-hidden="true" tabindex="-1"></a>total_defects <span class="op">=</span> <span class="bu">int</span>(total_pieces <span class="op">*</span> defect_rate)  <span class="co"># 100 défauts</span></span>
<span id="cb19-816"><a href="#cb19-816" aria-hidden="true" tabindex="-1"></a>total_ok <span class="op">=</span> total_pieces <span class="op">-</span> total_defects  <span class="co"># 9900 OK</span></span>
<span id="cb19-817"><a href="#cb19-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-818"><a href="#cb19-818" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des erreurs attendues</span></span>
<span id="cb19-819"><a href="#cb19-819" aria-hidden="true" tabindex="-1"></a>expected_fn <span class="op">=</span> <span class="bu">int</span>(total_defects <span class="op">*</span> fnr)  <span class="co"># Défauts non détectés</span></span>
<span id="cb19-820"><a href="#cb19-820" aria-hidden="true" tabindex="-1"></a>expected_fp <span class="op">=</span> <span class="bu">int</span>(total_ok <span class="op">*</span> fpr)  <span class="co"># OK rejetés à tort</span></span>
<span id="cb19-821"><a href="#cb19-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-822"><a href="#cb19-822" aria-hidden="true" tabindex="-1"></a>cout_fn <span class="op">=</span> expected_fn <span class="op">*</span> <span class="dv">500</span>  <span class="co"># Défauts non détectés</span></span>
<span id="cb19-823"><a href="#cb19-823" aria-hidden="true" tabindex="-1"></a>cout_fp <span class="op">=</span> expected_fp <span class="op">*</span> <span class="dv">10</span>   <span class="co"># OK rejetés</span></span>
<span id="cb19-824"><a href="#cb19-824" aria-hidden="true" tabindex="-1"></a>cout_inspection <span class="op">=</span> (expected_fn <span class="op">+</span> expected_fp) <span class="op">*</span> <span class="dv">0</span>  <span class="co"># Pas d'inspection pour erreurs</span></span>
<span id="cb19-825"><a href="#cb19-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-826"><a href="#cb19-826" aria-hidden="true" tabindex="-1"></a>cout_total <span class="op">=</span> cout_fn <span class="op">+</span> cout_fp</span>
<span id="cb19-827"><a href="#cb19-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-828"><a href="#cb19-828" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Production journalière:     </span><span class="sc">{</span>total_pieces<span class="sc">:,}</span><span class="ss"> pièces"</span>)</span>
<span id="cb19-829"><a href="#cb19-829" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Défauts réels:              </span><span class="sc">{</span>total_defects<span class="sc">}</span><span class="ss"> pièces (</span><span class="sc">{</span>defect_rate<span class="sc">:.1%}</span><span class="ss">)"</span>)</span>
<span id="cb19-830"><a href="#cb19-830" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Erreurs attendues:"</span>)</span>
<span id="cb19-831"><a href="#cb19-831" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - FN (défauts manqués):   </span><span class="sc">{</span>expected_fn<span class="sc">}</span><span class="ss"> × 500€ = </span><span class="sc">{</span>cout_fn<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-832"><a href="#cb19-832" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - FP (OK rejetés):        </span><span class="sc">{</span>expected_fp<span class="sc">}</span><span class="ss"> × 10€  = </span><span class="sc">{</span>cout_fp<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-833"><a href="#cb19-833" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Coût total des erreurs:     </span><span class="sc">{</span>cout_total<span class="sc">:,}</span><span class="ss">€/jour"</span>)</span>
<span id="cb19-834"><a href="#cb19-834" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Coût mensuel (22 jours):    </span><span class="sc">{</span>cout_total<span class="op">*</span><span class="dv">22</span><span class="sc">:,}</span><span class="ss">€/mois"</span>)</span>
<span id="cb19-835"><a href="#cb19-835" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Coût annuel (250 jours):    </span><span class="sc">{</span>cout_total<span class="op">*</span><span class="dv">250</span><span class="sc">:,}</span><span class="ss">€/an"</span>)</span>
<span id="cb19-836"><a href="#cb19-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-837"><a href="#cb19-837" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Métrique à optimiser</span></span>
<span id="cb19-838"><a href="#cb19-838" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. MÉTRIQUE À OPTIMISER:"</span>)</span>
<span id="cb19-839"><a href="#cb19-839" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-840"><a href="#cb19-840" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"→ RECALL (priorité absolue)"</span>)</span>
<span id="cb19-841"><a href="#cb19-841" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Raison: Le coût d'un FN (500€) est 50× plus élevé"</span>)</span>
<span id="cb19-842"><a href="#cb19-842" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"        que le coût d'un FP (10€)"</span>)</span>
<span id="cb19-843"><a href="#cb19-843" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Ratio coût FN/FP: </span><span class="sc">{</span><span class="dv">500</span><span class="op">/</span><span class="dv">10</span><span class="sc">:.0f}</span><span class="ss">:1"</span>)</span>
<span id="cb19-844"><a href="#cb19-844" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Stratégie: Maximiser le Recall, même au prix de"</span>)</span>
<span id="cb19-845"><a href="#cb19-845" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"           la Precision (plus de fausses alarmes acceptable)"</span>)</span>
<span id="cb19-846"><a href="#cb19-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-847"><a href="#cb19-847" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Amélioration</span></span>
<span id="cb19-848"><a href="#cb19-848" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">5. PROPOSITIONS D'AMÉLIORATION:"</span>)</span>
<span id="cb19-849"><a href="#cb19-849" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-850"><a href="#cb19-850" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">A. Court terme (ajustement du seuil):"</span>)</span>
<span id="cb19-851"><a href="#cb19-851" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Abaisser le seuil de décision (ex: 0.5 → 0.2)"</span>)</span>
<span id="cb19-852"><a href="#cb19-852" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Objectif: Recall &gt; 90%"</span>)</span>
<span id="cb19-853"><a href="#cb19-853" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Conséquence: Plus de FP (mais coût acceptable)"</span>)</span>
<span id="cb19-854"><a href="#cb19-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-855"><a href="#cb19-855" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation avec recall amélioré</span></span>
<span id="cb19-856"><a href="#cb19-856" aria-hidden="true" tabindex="-1"></a>recall_target <span class="op">=</span> <span class="fl">0.90</span></span>
<span id="cb19-857"><a href="#cb19-857" aria-hidden="true" tabindex="-1"></a>fn_new <span class="op">=</span> <span class="bu">int</span>(total_defects <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> recall_target))  <span class="co"># 10 défauts manqués</span></span>
<span id="cb19-858"><a href="#cb19-858" aria-hidden="true" tabindex="-1"></a><span class="co"># Supposons que Precision baisse à 20%</span></span>
<span id="cb19-859"><a href="#cb19-859" aria-hidden="true" tabindex="-1"></a>precision_new <span class="op">=</span> <span class="fl">0.20</span></span>
<span id="cb19-860"><a href="#cb19-860" aria-hidden="true" tabindex="-1"></a>fp_new <span class="op">=</span> <span class="bu">int</span>((total_defects <span class="op">*</span> recall_target) <span class="op">/</span> precision_new <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> precision_new))</span>
<span id="cb19-861"><a href="#cb19-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-862"><a href="#cb19-862" aria-hidden="true" tabindex="-1"></a>cout_fn_new <span class="op">=</span> fn_new <span class="op">*</span> <span class="dv">500</span></span>
<span id="cb19-863"><a href="#cb19-863" aria-hidden="true" tabindex="-1"></a>cout_fp_new <span class="op">=</span> fp_new <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb19-864"><a href="#cb19-864" aria-hidden="true" tabindex="-1"></a>cout_total_new <span class="op">=</span> cout_fn_new <span class="op">+</span> cout_fp_new</span>
<span id="cb19-865"><a href="#cb19-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-866"><a href="#cb19-866" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Simulation avec Recall=90%, Precision=20%:"</span>)</span>
<span id="cb19-867"><a href="#cb19-867" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - FN: </span><span class="sc">{</span>fn_new<span class="sc">}</span><span class="ss"> × 500€ = </span><span class="sc">{</span>cout_fn_new<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-868"><a href="#cb19-868" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - FP: </span><span class="sc">{</span>fp_new<span class="sc">}</span><span class="ss"> × 10€ = </span><span class="sc">{</span>cout_fp_new<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-869"><a href="#cb19-869" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Coût total: </span><span class="sc">{</span>cout_total_new<span class="sc">:,}</span><span class="ss">€/jour"</span>)</span>
<span id="cb19-870"><a href="#cb19-870" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Économie: </span><span class="sc">{</span>cout_total <span class="op">-</span> cout_total_new<span class="sc">:,}</span><span class="ss">€/jour"</span>)</span>
<span id="cb19-871"><a href="#cb19-871" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - ROI annuel: </span><span class="sc">{</span>(cout_total <span class="op">-</span> cout_total_new)<span class="op">*</span><span class="dv">250</span><span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-872"><a href="#cb19-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-873"><a href="#cb19-873" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">B. Moyen terme (amélioration du modèle):"</span>)</span>
<span id="cb19-874"><a href="#cb19-874" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Collecter plus de données (surtout défauts)"</span>)</span>
<span id="cb19-875"><a href="#cb19-875" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Feature engineering (nouvelles caractéristiques)"</span>)</span>
<span id="cb19-876"><a href="#cb19-876" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Essayer d'autres algorithmes (XGBoost, CNN)"</span>)</span>
<span id="cb19-877"><a href="#cb19-877" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   4. Data augmentation pour la classe minoritaire"</span>)</span>
<span id="cb19-878"><a href="#cb19-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-879"><a href="#cb19-879" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">C. Long terme (approche hybride):"</span>)</span>
<span id="cb19-880"><a href="#cb19-880" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Modèle ML comme premier filtre (Recall élevé)"</span>)</span>
<span id="cb19-881"><a href="#cb19-881" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Inspection manuelle des cas suspects"</span>)</span>
<span id="cb19-882"><a href="#cb19-882" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Double vérification pour cas limites"</span>)</span>
<span id="cb19-883"><a href="#cb19-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-884"><a href="#cb19-884" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb19-885"><a href="#cb19-885" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb19-886"><a href="#cb19-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-887"><a href="#cb19-887" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb19-888"><a href="#cb19-888" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> np.array([[tn, fp], [fn, tp]])</span>
<span id="cb19-889"><a href="#cb19-889" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>],</span>
<span id="cb19-890"><a href="#cb19-890" aria-hidden="true" tabindex="-1"></a>            xticklabels<span class="op">=</span>[<span class="st">'OK'</span>, <span class="st">'Défectueux'</span>],</span>
<span id="cb19-891"><a href="#cb19-891" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>[<span class="st">'OK'</span>, <span class="st">'Défectueux'</span>])</span>
<span id="cb19-892"><a href="#cb19-892" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Vraie Classe'</span>)</span>
<span id="cb19-893"><a href="#cb19-893" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Prédiction'</span>)</span>
<span id="cb19-894"><a href="#cb19-894" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Matrice de Confusion'</span>)</span>
<span id="cb19-895"><a href="#cb19-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-896"><a href="#cb19-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison coûts</span></span>
<span id="cb19-897"><a href="#cb19-897" aria-hidden="true" tabindex="-1"></a>scenarios <span class="op">=</span> [<span class="st">'Modèle Actuel</span><span class="ch">\n</span><span class="st">(Recall=70%)'</span>, </span>
<span id="cb19-898"><a href="#cb19-898" aria-hidden="true" tabindex="-1"></a>             <span class="st">'Modèle Amélioré</span><span class="ch">\n</span><span class="st">(Recall=90%)'</span>]</span>
<span id="cb19-899"><a href="#cb19-899" aria-hidden="true" tabindex="-1"></a>couts <span class="op">=</span> [cout_total, cout_total_new]</span>
<span id="cb19-900"><a href="#cb19-900" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#ff6b6b'</span>, <span class="st">'#51cf66'</span>]</span>
<span id="cb19-901"><a href="#cb19-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-902"><a href="#cb19-902" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].bar(scenarios, couts, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb19-903"><a href="#cb19-903" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Coût journalier (€)'</span>)</span>
<span id="cb19-904"><a href="#cb19-904" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Comparaison des Coûts'</span>)</span>
<span id="cb19-905"><a href="#cb19-905" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-906"><a href="#cb19-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-907"><a href="#cb19-907" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (scenario, cout) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(scenarios, couts)):</span>
<span id="cb19-908"><a href="#cb19-908" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text(i, cout <span class="op">+</span> <span class="dv">100</span>, <span class="ss">f'</span><span class="sc">{</span>cout<span class="sc">:,}</span><span class="ss">€'</span>, </span>
<span id="cb19-909"><a href="#cb19-909" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-910"><a href="#cb19-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-911"><a href="#cb19-911" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-912"><a href="#cb19-912" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-913"><a href="#cb19-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-914"><a href="#cb19-914" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau récapitulatif</span></span>
<span id="cb19-915"><a href="#cb19-915" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-916"><a href="#cb19-916" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLEAU RÉCAPITULATIF"</span>)</span>
<span id="cb19-917"><a href="#cb19-917" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-918"><a href="#cb19-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-919"><a href="#cb19-919" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb19-920"><a href="#cb19-920" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Métrique'</span>: [<span class="st">'Recall'</span>, <span class="st">'Precision'</span>, <span class="st">'FN/jour'</span>, <span class="st">'FP/jour'</span>, <span class="st">'Coût/jour'</span>],</span>
<span id="cb19-921"><a href="#cb19-921" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Actuel'</span>: [<span class="ss">f'</span><span class="sc">{</span>recall<span class="sc">:.1%}</span><span class="ss">'</span>, <span class="ss">f'</span><span class="sc">{</span>precision<span class="sc">:.1%}</span><span class="ss">'</span>, expected_fn, expected_fp, <span class="ss">f'</span><span class="sc">{</span>cout_total<span class="sc">:,}</span><span class="ss">€'</span>],</span>
<span id="cb19-922"><a href="#cb19-922" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Cible'</span>: [<span class="st">'90%'</span>, <span class="st">'20%'</span>, fn_new, fp_new, <span class="ss">f'</span><span class="sc">{</span>cout_total_new<span class="sc">:,}</span><span class="ss">€'</span>],</span>
<span id="cb19-923"><a href="#cb19-923" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Amélioration'</span>: [<span class="st">'↑ +20pp'</span>, <span class="st">'↓ -6pp'</span>, <span class="ss">f'↓ -</span><span class="sc">{</span>expected_fn<span class="op">-</span>fn_new<span class="sc">}</span><span class="ss">'</span>, <span class="ss">f'↑ +</span><span class="sc">{</span>fp_new<span class="op">-</span>expected_fp<span class="sc">}</span><span class="ss">'</span>, </span>
<span id="cb19-924"><a href="#cb19-924" aria-hidden="true" tabindex="-1"></a>                     <span class="ss">f'↓ -</span><span class="sc">{</span>cout_total<span class="op">-</span>cout_total_new<span class="sc">:,}</span><span class="ss">€'</span>]</span>
<span id="cb19-925"><a href="#cb19-925" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb19-926"><a href="#cb19-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-927"><a href="#cb19-927" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb19-928"><a href="#cb19-928" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-929"><a href="#cb19-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-930"><a href="#cb19-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-931"><a href="#cb19-931" aria-hidden="true" tabindex="-1"></a>**Synthèse des réponses:**</span>
<span id="cb19-932"><a href="#cb19-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-933"><a href="#cb19-933" aria-hidden="true" tabindex="-1"></a>**1. Métriques:**</span>
<span id="cb19-934"><a href="#cb19-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-935"><a href="#cb19-935" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy: 97.70%</span>
<span id="cb19-936"><a href="#cb19-936" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Precision: 25.93% (7 sur 27 prédictions de défauts sont correctes)</span>
<span id="cb19-937"><a href="#cb19-937" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Recall: 70.00% (7 sur 10 vrais défauts détectés)</span>
<span id="cb19-938"><a href="#cb19-938" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>F1-Score: 38.89%</span>
<span id="cb19-939"><a href="#cb19-939" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Specificity: 97.98%</span>
<span id="cb19-940"><a href="#cb19-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-941"><a href="#cb19-941" aria-hidden="true" tabindex="-1"></a>**2. Acceptabilité métier:**</span>
<span id="cb19-942"><a href="#cb19-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-943"><a href="#cb19-943" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>❌ **NON ACCEPTABLE**</span>
<span id="cb19-944"><a href="#cb19-944" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Recall de 70% signifie 30% de défauts non détectés</span>
<span id="cb19-945"><a href="#cb19-945" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ces défauts atteignent les clients → réputation + coûts</span>
<span id="cb19-946"><a href="#cb19-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-947"><a href="#cb19-947" aria-hidden="true" tabindex="-1"></a>**3. Coût journalier:**</span>
<span id="cb19-948"><a href="#cb19-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-949"><a href="#cb19-949" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>FN: 30 défauts × 500€ = **15,000€/jour**</span>
<span id="cb19-950"><a href="#cb19-950" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>FP: 200 pièces × 10€ = **2,000€/jour**</span>
<span id="cb19-951"><a href="#cb19-951" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Total: 17,000€/jour** ($\approx$ 4.25M€/an!)</span>
<span id="cb19-952"><a href="#cb19-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-953"><a href="#cb19-953" aria-hidden="true" tabindex="-1"></a>**4. Métrique à optimiser:**</span>
<span id="cb19-954"><a href="#cb19-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-955"><a href="#cb19-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RECALL** (priorité absolue)</span>
<span id="cb19-956"><a href="#cb19-956" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ratio coût 50:1 en faveur de l'augmentation du Recall</span>
<span id="cb19-957"><a href="#cb19-957" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accepter plus de FP pour réduire FN</span>
<span id="cb19-958"><a href="#cb19-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-959"><a href="#cb19-959" aria-hidden="true" tabindex="-1"></a>**5. Amélioration proposée:**</span>
<span id="cb19-960"><a href="#cb19-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-961"><a href="#cb19-961" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Abaisser seuil → Recall 90%+</span>
<span id="cb19-962"><a href="#cb19-962" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Économie potentielle: ~10,000€/jour</span>
<span id="cb19-963"><a href="#cb19-963" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ROI annuel: ~2.5M€</span>
<span id="cb19-964"><a href="#cb19-964" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-965"><a href="#cb19-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-966"><a href="#cb19-966" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Comparaison Critique des Résultats</span></span>
<span id="cb19-967"><a href="#cb19-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-968"><a href="#cb19-968" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercice 6.1: Analyse Comparative</span></span>
<span id="cb19-969"><a href="#cb19-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-970"><a href="#cb19-970" aria-hidden="true" tabindex="-1"></a>Trois data scientists ont entraîné des modèles pour détecter des défaillances machines:</span>
<span id="cb19-971"><a href="#cb19-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-972"><a href="#cb19-972" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Modèle <span class="pp">|</span> Accuracy <span class="pp">|</span> Precision <span class="pp">|</span> Recall <span class="pp">|</span> F1 <span class="pp">|</span> AUC <span class="pp">|</span></span>
<span id="cb19-973"><a href="#cb19-973" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|----------|-----------|--------|----|----|</span></span>
<span id="cb19-974"><a href="#cb19-974" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> A <span class="pp">|</span> 98% <span class="pp">|</span> 40% <span class="pp">|</span> 95% <span class="pp">|</span> 56% <span class="pp">|</span> 0.92 <span class="pp">|</span></span>
<span id="cb19-975"><a href="#cb19-975" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> B <span class="pp">|</span> 95% <span class="pp">|</span> 80% <span class="pp">|</span> 70% <span class="pp">|</span> 75% <span class="pp">|</span> 0.88 <span class="pp">|</span></span>
<span id="cb19-976"><a href="#cb19-976" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C <span class="pp">|</span> 99% <span class="pp">|</span> 20% <span class="pp">|</span> 60% <span class="pp">|</span> 30% <span class="pp">|</span> 0.75 <span class="pp">|</span></span>
<span id="cb19-977"><a href="#cb19-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-978"><a href="#cb19-978" aria-hidden="true" tabindex="-1"></a>**Contexte:** 2% de défaillances, coût FN = 10,000€, coût FP = 100€</span>
<span id="cb19-979"><a href="#cb19-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-980"><a href="#cb19-980" aria-hidden="true" tabindex="-1"></a>**Questions:**</span>
<span id="cb19-981"><a href="#cb19-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-982"><a href="#cb19-982" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Quel modèle recommandez-vous?</span>
<span id="cb19-983"><a href="#cb19-983" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Justifiez votre choix avec calculs de coûts</span>
<span id="cb19-984"><a href="#cb19-984" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Que révèle l'Accuracy élevée du modèle C?</span>
<span id="cb19-985"><a href="#cb19-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-986"><a href="#cb19-986" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb19-987"><a href="#cb19-987" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Exercice 6.1</span></span>
<span id="cb19-988"><a href="#cb19-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-991"><a href="#cb19-991" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-992"><a href="#cb19-992" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-993"><a href="#cb19-993" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-994"><a href="#cb19-994" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-995"><a href="#cb19-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-996"><a href="#cb19-996" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb19-997"><a href="#cb19-997" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-998"><a href="#cb19-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-999"><a href="#cb19-999" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb19-1000"><a href="#cb19-1000" aria-hidden="true" tabindex="-1"></a>models_data <span class="op">=</span> {</span>
<span id="cb19-1001"><a href="#cb19-1001" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Modèle'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>],</span>
<span id="cb19-1002"><a href="#cb19-1002" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>: [<span class="fl">0.98</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>],</span>
<span id="cb19-1003"><a href="#cb19-1003" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>: [<span class="fl">0.40</span>, <span class="fl">0.80</span>, <span class="fl">0.20</span>],</span>
<span id="cb19-1004"><a href="#cb19-1004" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>: [<span class="fl">0.95</span>, <span class="fl">0.70</span>, <span class="fl">0.60</span>],</span>
<span id="cb19-1005"><a href="#cb19-1005" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>: [<span class="fl">0.56</span>, <span class="fl">0.75</span>, <span class="fl">0.30</span>],</span>
<span id="cb19-1006"><a href="#cb19-1006" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AUC'</span>: [<span class="fl">0.92</span>, <span class="fl">0.88</span>, <span class="fl">0.75</span>]</span>
<span id="cb19-1007"><a href="#cb19-1007" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-1008"><a href="#cb19-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1009"><a href="#cb19-1009" aria-hidden="true" tabindex="-1"></a>df_models <span class="op">=</span> pd.DataFrame(models_data)</span>
<span id="cb19-1010"><a href="#cb19-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1011"><a href="#cb19-1011" aria-hidden="true" tabindex="-1"></a><span class="co"># Contexte</span></span>
<span id="cb19-1012"><a href="#cb19-1012" aria-hidden="true" tabindex="-1"></a>defect_rate <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb19-1013"><a href="#cb19-1013" aria-hidden="true" tabindex="-1"></a>total_samples <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb19-1014"><a href="#cb19-1014" aria-hidden="true" tabindex="-1"></a>total_defects <span class="op">=</span> <span class="bu">int</span>(total_samples <span class="op">*</span> defect_rate)  <span class="co"># 200</span></span>
<span id="cb19-1015"><a href="#cb19-1015" aria-hidden="true" tabindex="-1"></a>total_normal <span class="op">=</span> total_samples <span class="op">-</span> total_defects  <span class="co"># 9800</span></span>
<span id="cb19-1016"><a href="#cb19-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1017"><a href="#cb19-1017" aria-hidden="true" tabindex="-1"></a>cost_fn <span class="op">=</span> <span class="dv">10000</span>  <span class="co"># Coût défaillance non détectée</span></span>
<span id="cb19-1018"><a href="#cb19-1018" aria-hidden="true" tabindex="-1"></a>cost_fp <span class="op">=</span> <span class="dv">100</span>    <span class="co"># Coût fausse alarme</span></span>
<span id="cb19-1019"><a href="#cb19-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1020"><a href="#cb19-1020" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANALYSE COMPARATIVE DES MODÈLES"</span>)</span>
<span id="cb19-1021"><a href="#cb19-1021" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1022"><a href="#cb19-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1023"><a href="#cb19-1023" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des coûts pour chaque modèle</span></span>
<span id="cb19-1024"><a href="#cb19-1024" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb19-1025"><a href="#cb19-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1026"><a href="#cb19-1026" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df_models.iterrows():</span>
<span id="cb19-1027"><a href="#cb19-1027" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> row[<span class="st">'Modèle'</span>]</span>
<span id="cb19-1028"><a href="#cb19-1028" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> row[<span class="st">'Recall'</span>]</span>
<span id="cb19-1029"><a href="#cb19-1029" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> row[<span class="st">'Precision'</span>]</span>
<span id="cb19-1030"><a href="#cb19-1030" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1031"><a href="#cb19-1031" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul des erreurs</span></span>
<span id="cb19-1032"><a href="#cb19-1032" aria-hidden="true" tabindex="-1"></a>    fn <span class="op">=</span> <span class="bu">int</span>(total_defects <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> recall))  <span class="co"># Défauts manqués</span></span>
<span id="cb19-1033"><a href="#cb19-1033" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> total_defects <span class="op">-</span> fn  <span class="co"># Défauts détectés</span></span>
<span id="cb19-1034"><a href="#cb19-1034" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1035"><a href="#cb19-1035" aria-hidden="true" tabindex="-1"></a>    <span class="co"># De precision = TP / (TP + FP), on déduit FP</span></span>
<span id="cb19-1036"><a href="#cb19-1036" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> precision <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb19-1037"><a href="#cb19-1037" aria-hidden="true" tabindex="-1"></a>        fp <span class="op">=</span> <span class="bu">int</span>(tp <span class="op">/</span> precision <span class="op">-</span> tp)  <span class="co"># Fausses alarmes</span></span>
<span id="cb19-1038"><a href="#cb19-1038" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb19-1039"><a href="#cb19-1039" aria-hidden="true" tabindex="-1"></a>        fp <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-1040"><a href="#cb19-1040" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1041"><a href="#cb19-1041" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coûts</span></span>
<span id="cb19-1042"><a href="#cb19-1042" aria-hidden="true" tabindex="-1"></a>    cost_fn_total <span class="op">=</span> fn <span class="op">*</span> cost_fn</span>
<span id="cb19-1043"><a href="#cb19-1043" aria-hidden="true" tabindex="-1"></a>    cost_fp_total <span class="op">=</span> fp <span class="op">*</span> cost_fp</span>
<span id="cb19-1044"><a href="#cb19-1044" aria-hidden="true" tabindex="-1"></a>    cost_total <span class="op">=</span> cost_fn_total <span class="op">+</span> cost_fp_total</span>
<span id="cb19-1045"><a href="#cb19-1045" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1046"><a href="#cb19-1046" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb19-1047"><a href="#cb19-1047" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Modèle'</span>: model,</span>
<span id="cb19-1048"><a href="#cb19-1048" aria-hidden="true" tabindex="-1"></a>        <span class="st">'FN'</span>: fn,</span>
<span id="cb19-1049"><a href="#cb19-1049" aria-hidden="true" tabindex="-1"></a>        <span class="st">'FP'</span>: fp,</span>
<span id="cb19-1050"><a href="#cb19-1050" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coût FN'</span>: cost_fn_total,</span>
<span id="cb19-1051"><a href="#cb19-1051" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coût FP'</span>: cost_fp_total,</span>
<span id="cb19-1052"><a href="#cb19-1052" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coût Total'</span>: cost_total</span>
<span id="cb19-1053"><a href="#cb19-1053" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb19-1054"><a href="#cb19-1054" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1055"><a href="#cb19-1055" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Modèle </span><span class="sc">{</span>model<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb19-1056"><a href="#cb19-1056" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Recall: </span><span class="sc">{</span>recall<span class="sc">:.0%}</span><span class="ss"> → FN = </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> défaillances manquées"</span>)</span>
<span id="cb19-1057"><a href="#cb19-1057" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Precision: </span><span class="sc">{</span>precision<span class="sc">:.0%}</span><span class="ss"> → FP = </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss"> fausses alarmes"</span>)</span>
<span id="cb19-1058"><a href="#cb19-1058" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Coût FN: </span><span class="sc">{</span>fn<span class="sc">}</span><span class="ss"> × </span><span class="sc">{</span>cost_fn<span class="sc">:,}</span><span class="ss">€ = </span><span class="sc">{</span>cost_fn_total<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-1059"><a href="#cb19-1059" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Coût FP: </span><span class="sc">{</span>fp<span class="sc">}</span><span class="ss"> × </span><span class="sc">{</span>cost_fp<span class="sc">:,}</span><span class="ss">€ = </span><span class="sc">{</span>cost_fp_total<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-1060"><a href="#cb19-1060" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  COÛT TOTAL: </span><span class="sc">{</span>cost_total<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-1061"><a href="#cb19-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1062"><a href="#cb19-1062" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb19-1063"><a href="#cb19-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1064"><a href="#cb19-1064" aria-hidden="true" tabindex="-1"></a><span class="co"># Meilleur modèle</span></span>
<span id="cb19-1065"><a href="#cb19-1065" aria-hidden="true" tabindex="-1"></a>best_model <span class="op">=</span> df_results.loc[df_results[<span class="st">'Coût Total'</span>].idxmin()]</span>
<span id="cb19-1066"><a href="#cb19-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1067"><a href="#cb19-1067" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1068"><a href="#cb19-1068" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RECOMMANDATION"</span>)</span>
<span id="cb19-1069"><a href="#cb19-1069" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1070"><a href="#cb19-1070" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"→ Modèle </span><span class="sc">{</span>best_model[<span class="st">'Modèle'</span>]<span class="sc">}</span><span class="ss"> (coût le plus faible)"</span>)</span>
<span id="cb19-1071"><a href="#cb19-1071" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Justification:"</span>)</span>
<span id="cb19-1072"><a href="#cb19-1072" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Coût total minimal: </span><span class="sc">{</span>best_model[<span class="st">'Coût Total'</span>]<span class="sc">:,}</span><span class="ss">€"</span>)</span>
<span id="cb19-1073"><a href="#cb19-1073" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Recall élevé (</span><span class="sc">{</span>df_models[df_models[<span class="st">'Modèle'</span>]<span class="op">==</span>best_model[<span class="st">'Modèle'</span>]][<span class="st">'Recall'</span>]<span class="sc">.</span>values[<span class="dv">0</span>]<span class="sc">:.0%}</span><span class="ss">) critique car FN très coûteux"</span>)</span>
<span id="cb19-1074"><a href="#cb19-1074" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Le surcoût en FP est négligeable comparé aux économies en FN"</span>)</span>
<span id="cb19-1075"><a href="#cb19-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1076"><a href="#cb19-1076" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1077"><a href="#cb19-1077" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANALYSE DU MODÈLE C"</span>)</span>
<span id="cb19-1078"><a href="#cb19-1078" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1079"><a href="#cb19-1079" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy de 99% mais performances médiocres:"</span>)</span>
<span id="cb19-1080"><a href="#cb19-1080" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  → Piège des classes déséquilibrées!"</span>)</span>
<span id="cb19-1081"><a href="#cb19-1081" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  → Avec 2% de défauts, prédire 'normal' partout"</span>)</span>
<span id="cb19-1082"><a href="#cb19-1082" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     donnerait déjà 98% d'accuracy"</span>)</span>
<span id="cb19-1083"><a href="#cb19-1083" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  → Recall de 60% = 40</span><span class="sc">% d</span><span class="st">e défauts manqués (inacceptable)"</span>)</span>
<span id="cb19-1084"><a href="#cb19-1084" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  → AUC faible (0.75) confirme faible capacité discriminative"</span>)</span>
<span id="cb19-1085"><a href="#cb19-1085" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">  Conclusion: Accuracy est une métrique TROMPEUSE ici!"</span>)</span>
<span id="cb19-1086"><a href="#cb19-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1087"><a href="#cb19-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisations</span></span>
<span id="cb19-1088"><a href="#cb19-1088" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb19-1089"><a href="#cb19-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1090"><a href="#cb19-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique 1: Comparaison des coûts</span></span>
<span id="cb19-1091"><a href="#cb19-1091" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_results[<span class="st">'Modèle'</span>]</span>
<span id="cb19-1092"><a href="#cb19-1092" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb19-1093"><a href="#cb19-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1094"><a href="#cb19-1094" aria-hidden="true" tabindex="-1"></a>x_pos <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(x))</span>
<span id="cb19-1095"><a href="#cb19-1095" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar([p <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> p <span class="kw">in</span> x_pos], df_results[<span class="st">'Coût FN'</span>], </span>
<span id="cb19-1096"><a href="#cb19-1096" aria-hidden="true" tabindex="-1"></a>           width, label<span class="op">=</span><span class="st">'Coût FN'</span>, color<span class="op">=</span><span class="st">'#ff6b6b'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb19-1097"><a href="#cb19-1097" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar([p <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> p <span class="kw">in</span> x_pos], df_results[<span class="st">'Coût FP'</span>], </span>
<span id="cb19-1098"><a href="#cb19-1098" aria-hidden="true" tabindex="-1"></a>           width, label<span class="op">=</span><span class="st">'Coût FP'</span>, color<span class="op">=</span><span class="st">'#ffa94d'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb19-1099"><a href="#cb19-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1100"><a href="#cb19-1100" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Modèle'</span>)</span>
<span id="cb19-1101"><a href="#cb19-1101" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Coût (€)'</span>)</span>
<span id="cb19-1102"><a href="#cb19-1102" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Comparaison des Coûts par Type d</span><span class="ch">\'</span><span class="st">Erreur'</span>)</span>
<span id="cb19-1103"><a href="#cb19-1103" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(x_pos)</span>
<span id="cb19-1104"><a href="#cb19-1104" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(x)</span>
<span id="cb19-1105"><a href="#cb19-1105" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb19-1106"><a href="#cb19-1106" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-1107"><a href="#cb19-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1108"><a href="#cb19-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter coût total</span></span>
<span id="cb19-1109"><a href="#cb19-1109" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (idx, row) <span class="kw">in</span> <span class="bu">enumerate</span>(df_results.iterrows()):</span>
<span id="cb19-1110"><a href="#cb19-1110" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> row[<span class="st">'Coût Total'</span>]</span>
<span id="cb19-1111"><a href="#cb19-1111" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].text(i, total <span class="op">+</span> <span class="dv">5000</span>, <span class="ss">f'</span><span class="sc">{</span>total<span class="sc">:,}</span><span class="ss">€'</span>, </span>
<span id="cb19-1112"><a href="#cb19-1112" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-1113"><a href="#cb19-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1114"><a href="#cb19-1114" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique 2: Radar chart des métriques</span></span>
<span id="cb19-1115"><a href="#cb19-1115" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi</span>
<span id="cb19-1116"><a href="#cb19-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1117"><a href="#cb19-1117" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1'</span>, <span class="st">'AUC'</span>]</span>
<span id="cb19-1118"><a href="#cb19-1118" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(categories)</span>
<span id="cb19-1119"><a href="#cb19-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1120"><a href="#cb19-1120" aria-hidden="true" tabindex="-1"></a>angles <span class="op">=</span> [n <span class="op">/</span> <span class="bu">float</span>(N) <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> pi <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb19-1121"><a href="#cb19-1121" aria-hidden="true" tabindex="-1"></a>angles <span class="op">+=</span> angles[:<span class="dv">1</span>]</span>
<span id="cb19-1122"><a href="#cb19-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1123"><a href="#cb19-1123" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">122</span>, projection<span class="op">=</span><span class="st">'polar'</span>)</span>
<span id="cb19-1124"><a href="#cb19-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1125"><a href="#cb19-1125" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df_models.iterrows():</span>
<span id="cb19-1126"><a href="#cb19-1126" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> [row[<span class="st">'Accuracy'</span>], row[<span class="st">'Precision'</span>], row[<span class="st">'Recall'</span>], </span>
<span id="cb19-1127"><a href="#cb19-1127" aria-hidden="true" tabindex="-1"></a>              row[<span class="st">'F1'</span>], row[<span class="st">'AUC'</span>]]</span>
<span id="cb19-1128"><a href="#cb19-1128" aria-hidden="true" tabindex="-1"></a>    values <span class="op">+=</span> values[:<span class="dv">1</span>]</span>
<span id="cb19-1129"><a href="#cb19-1129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1130"><a href="#cb19-1130" aria-hidden="true" tabindex="-1"></a>    ax.plot(angles, values, <span class="st">'o-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f"Modèle </span><span class="sc">{</span>row[<span class="st">'Modèle'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-1131"><a href="#cb19-1131" aria-hidden="true" tabindex="-1"></a>    ax.fill(angles, values, alpha<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb19-1132"><a href="#cb19-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1133"><a href="#cb19-1133" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(angles[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb19-1134"><a href="#cb19-1134" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(categories)</span>
<span id="cb19-1135"><a href="#cb19-1135" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-1136"><a href="#cb19-1136" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Comparaison Multidimensionnelle des Métriques'</span>, y<span class="op">=</span><span class="fl">1.08</span>)</span>
<span id="cb19-1137"><a href="#cb19-1137" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.3</span>, <span class="fl">1.1</span>))</span>
<span id="cb19-1138"><a href="#cb19-1138" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb19-1139"><a href="#cb19-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1140"><a href="#cb19-1140" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-1141"><a href="#cb19-1141" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-1142"><a href="#cb19-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1143"><a href="#cb19-1143" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau final</span></span>
<span id="cb19-1144"><a href="#cb19-1144" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1145"><a href="#cb19-1145" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLEAU RÉCAPITULATIF"</span>)</span>
<span id="cb19-1146"><a href="#cb19-1146" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-1147"><a href="#cb19-1147" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_results.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb19-1148"><a href="#cb19-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-1149"><a href="#cb19-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1150"><a href="#cb19-1150" aria-hidden="true" tabindex="-1"></a>**Réponses:**</span>
<span id="cb19-1151"><a href="#cb19-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1152"><a href="#cb19-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Modèle recommandé: A**</span>
<span id="cb19-1153"><a href="#cb19-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1154"><a href="#cb19-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Justification avec coûts:**</span>
<span id="cb19-1155"><a href="#cb19-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Modèle A: 10 FN × 10,000€ + 475 FP × 100€ = **147,500€**</span>
<span id="cb19-1156"><a href="#cb19-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Modèle B: 60 FN × 10,000€ + 175 FP × 100€ = **617,500€**</span>
<span id="cb19-1157"><a href="#cb19-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Modèle C: 80 FN × 10,000€ + 600 FP × 100€ = **860,000€**</span>
<span id="cb19-1158"><a href="#cb19-1158" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb19-1159"><a href="#cb19-1159" aria-hidden="true" tabindex="-1"></a>   Le Modèle A minimise le coût total malgré plus de FP</span>
<span id="cb19-1160"><a href="#cb19-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1161"><a href="#cb19-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Accuracy élevée du Modèle C:**</span>
<span id="cb19-1162"><a href="#cb19-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Piège classique des classes déséquilibrées!</span>
<span id="cb19-1163"><a href="#cb19-1163" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>99% accuracy car prédit surtout "normal"</span>
<span id="cb19-1164"><a href="#cb19-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mais rate 40% des défaillances (Recall = 60%)</span>
<span id="cb19-1165"><a href="#cb19-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Leçon**: Accuracy seule est trompeuse avec déséquilibre</span>
<span id="cb19-1166"><a href="#cb19-1166" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-1167"><a href="#cb19-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1168"><a href="#cb19-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Résumé de la Séance</span></span>
<span id="cb19-1169"><a href="#cb19-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1170"><a href="#cb19-1170" aria-hidden="true" tabindex="-1"></a>::: {.callout-important icon=false}</span>
<span id="cb19-1171"><a href="#cb19-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Points clés à retenir</span></span>
<span id="cb19-1172"><a href="#cb19-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1173"><a href="#cb19-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Matrice de Confusion</span></span>
<span id="cb19-1174"><a href="#cb19-1174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fondation de toutes les métriques</span>
<span id="cb19-1175"><a href="#cb19-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>TP, TN, FP, FN à bien comprendre</span>
<span id="cb19-1176"><a href="#cb19-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualisation claire des erreurs</span>
<span id="cb19-1177"><a href="#cb19-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1178"><a href="#cb19-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Métriques Principales</span></span>
<span id="cb19-1179"><a href="#cb19-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accuracy**: % correct (attention au déséquilibre!)</span>
<span id="cb19-1180"><a href="#cb19-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Precision**: Fiabilité des prédictions positives</span>
<span id="cb19-1181"><a href="#cb19-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recall**: Couverture des vrais positifs</span>
<span id="cb19-1182"><a href="#cb19-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**F1-Score**: Équilibre Precision-Recall</span>
<span id="cb19-1183"><a href="#cb19-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1184"><a href="#cb19-1184" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Compromis</span></span>
<span id="cb19-1185"><a href="#cb19-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Precision ↑ → Recall ↓ (généralement)</span>
<span id="cb19-1186"><a href="#cb19-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Choix selon le coût des erreurs</span>
<span id="cb19-1187"><a href="#cb19-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ajustement du seuil de décision</span>
<span id="cb19-1188"><a href="#cb19-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1189"><a href="#cb19-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Courbe ROC et AUC</span></span>
<span id="cb19-1190"><a href="#cb19-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Évaluation indépendante du seuil</span>
<span id="cb19-1191"><a href="#cb19-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AUC = mesure globale de discrimination</span>
<span id="cb19-1192"><a href="#cb19-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparaison facile de modèles</span>
<span id="cb19-1193"><a href="#cb19-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1194"><a href="#cb19-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. Choix Contextuel</span></span>
<span id="cb19-1195"><a href="#cb19-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pas de métrique universelle!**</span>
<span id="cb19-1196"><a href="#cb19-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dépend du problème métier</span>
<span id="cb19-1197"><a href="#cb19-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Considérer les coûts réels des erreurs</span>
<span id="cb19-1198"><a href="#cb19-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Classes déséquilibrées → éviter Accuracy seule</span>
<span id="cb19-1199"><a href="#cb19-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1200"><a href="#cb19-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. Règles d'Or</span></span>
<span id="cb19-1201"><a href="#cb19-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Toujours regarder plusieurs métriques</span>
<span id="cb19-1202"><a href="#cb19-1202" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Privilégier Recall si FN coûteux</span>
<span id="cb19-1203"><a href="#cb19-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Privilégier Precision si FP coûteux</span>
<span id="cb19-1204"><a href="#cb19-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Utiliser AUC pour comparer modèles</span>
<span id="cb19-1205"><a href="#cb19-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Valider avec coûts métier réels</span>
<span id="cb19-1206"><a href="#cb19-1206" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-1207"><a href="#cb19-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1208"><a href="#cb19-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checklist de Maîtrise</span></span>
<span id="cb19-1209"><a href="#cb19-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1210"><a href="#cb19-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je sais construire et interpréter une matrice de confusion</span>
<span id="cb19-1211"><a href="#cb19-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je comprends la différence entre Precision et Recall</span>
<span id="cb19-1212"><a href="#cb19-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je peux expliquer pourquoi Accuracy peut être trompeuse</span>
<span id="cb19-1213"><a href="#cb19-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je sais calculer manuellement les métriques de base</span>
<span id="cb19-1214"><a href="#cb19-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je comprends le compromis Precision-Recall</span>
<span id="cb19-1215"><a href="#cb19-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je sais interpréter une courbe ROC et l'AUC</span>
<span id="cb19-1216"><a href="#cb19-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je peux choisir la métrique appropriée selon le contexte</span>
<span id="cb19-1217"><a href="#cb19-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Je comprends l'impact des classes déséquilibrées</span>
<span id="cb19-1218"><a href="#cb19-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1219"><a href="#cb19-1219" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercices Supplémentaires</span></span>
<span id="cb19-1220"><a href="#cb19-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1221"><a href="#cb19-1221" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb19-1222"><a href="#cb19-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pour s'entraîner</span></span>
<span id="cb19-1223"><a href="#cb19-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1224"><a href="#cb19-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Implémentez** toutes les métriques vues en Python sans Scikit-learn</span>
<span id="cb19-1225"><a href="#cb19-1225" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Créez** une fonction qui recommande la meilleure métrique selon le contexte</span>
<span id="cb19-1226"><a href="#cb19-1226" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Analysez** un dataset déséquilibré (ex: fraude, maladie rare) sur Kaggle</span>
<span id="cb19-1227"><a href="#cb19-1227" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Comparez** plusieurs modèles sur le même problème avec toutes les métriques</span>
<span id="cb19-1228"><a href="#cb19-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Explorez** l'effet du seuil de décision sur Precision et Recall</span>
<span id="cb19-1229"><a href="#cb19-1229" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-1230"><a href="#cb19-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1231"><a href="#cb19-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">## Préparation Séance Suivante</span></span>
<span id="cb19-1232"><a href="#cb19-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1233"><a href="#cb19-1233" aria-hidden="true" tabindex="-1"></a>La **Séance 6 (TP2)** abordera:</span>
<span id="cb19-1234"><a href="#cb19-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1235"><a href="#cb19-1235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Classification multi-classes</span>
<span id="cb19-1236"><a href="#cb19-1236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Optimisation d'hyperparamètres (GridSearchCV, RandomizedSearchCV)</span>
<span id="cb19-1237"><a href="#cb19-1237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Validation croisée</span>
<span id="cb19-1238"><a href="#cb19-1238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparaison avancée de modèles</span>
<span id="cb19-1239"><a href="#cb19-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1240"><a href="#cb19-1240" aria-hidden="true" tabindex="-1"></a>**À préparer:**</span>
<span id="cb19-1241"><a href="#cb19-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1242"><a href="#cb19-1242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Relire les concepts de validation croisée</span>
<span id="cb19-1243"><a href="#cb19-1243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Installer scikit-learn à jour</span>
<span id="cb19-1244"><a href="#cb19-1244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Réfléchir aux hyperparamètres importants de chaque algorithme</span>
<span id="cb19-1245"><a href="#cb19-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1246"><a href="#cb19-1246" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ressources Complémentaires</span></span>
<span id="cb19-1247"><a href="#cb19-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1248"><a href="#cb19-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="co">[</span><span class="ot">Scikit-learn: Model Evaluation</span><span class="co">](https://scikit-learn.org/stable/modules/model_evaluation.html)</span></span>
<span id="cb19-1249"><a href="#cb19-1249" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="co">[</span><span class="ot">Google ML Crash Course: Classification</span><span class="co">](https://developers.google.com/machine-learning/crash-course/classification)</span></span>
<span id="cb19-1250"><a href="#cb19-1250" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="co">[</span><span class="ot">StatQuest: Sensitivity and Specificity</span><span class="co">](https://www.youtube.com/watch?v=vP06aMoz4v8)</span></span>
<span id="cb19-1251"><a href="#cb19-1251" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="co">[</span><span class="ot">Towards Data Science: Beyond Accuracy</span><span class="co">](https://towardsdatascience.com/beyond-accuracy-precision-and-recall-3da06bea9f6c)</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>